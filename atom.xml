<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>情文のBLOG</title>
  
  <subtitle>记录点点滴滴</subtitle>
  <link href="https://www.mingilin.com/atom.xml" rel="self"/>
  
  <link href="https://www.mingilin.com/"/>
  <updated>2021-11-24T01:49:12.903Z</updated>
  <id>https://www.mingilin.com/</id>
  
  <author>
    <name>kingwen0302</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>使用fpm打包</title>
    <link href="https://www.mingilin.com/2021/11/24/centos/centos-fpm/"/>
    <id>https://www.mingilin.com/2021/11/24/centos/centos-fpm/</id>
    <published>2021-11-24T02:00:00.000Z</published>
    <updated>2021-11-24T01:49:12.903Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://github.com/jordansissel/fpm">fpm</a><br>The goal of fpm is to make it easy and quick to build packages such as rpms, debs, OSX packages, etc.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fpm -p outdir -s dir -t rpm -n website --iteration 1.el6 -d aaa -d psmisc -v 1.0.1 -C ~/hello/</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># -p 输出目录</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># -d 依赖</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># -v 版本</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># -n name</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># -C 包目录,~/hello/ =&gt; /</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          ~/hello/usr/bin/hello =&gt; /usr/bin/hello</span></span> </span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="centos" scheme="https://www.mingilin.com/categories/centos/"/>
    
    
    <category term="centos" scheme="https://www.mingilin.com/tags/centos/"/>
    
  </entry>
  
  <entry>
    <title>ios15 修复websocket ssl连接失败的问题</title>
    <link href="https://www.mingilin.com/2021/09/29/erlang/erlang-ios15-wss/"/>
    <id>https://www.mingilin.com/2021/09/29/erlang/erlang-ios15-wss/</id>
    <published>2021-09-29T04:00:00.000Z</published>
    <updated>2021-09-29T04:12:55.312Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>玩家反馈，ios15无法登录游戏，android和ios其他版本没有问题</p><p>分析发现，ios15将原本是一条数据内容分成三份发送</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">## 本来这应该是一条数据的</span><br><span class="line">## FIN - Payload len</span><br><span class="line">websocket:request:53 [mfa:proc_lib:init_p/5] parse_frames:&#123;ssl,hybi,&lt;&lt;130,131&gt;&gt;,&#123;ssl,&#123;sslsocket,&#123;gen_tcp,#Port&lt;0.17851&gt;,tls_connection,&lt;0.533.0&gt;&#125;,&lt;0.6628.124&gt;&#125;&#125;&#125;</span><br><span class="line">## Masking-key</span><br><span class="line">websocket:request:53 [mfa:proc_lib:init_p/5] parse_frames:&#123;ssl,hybi,&lt;&lt;153,193,1,85&gt;&gt;,&#123;ssl,&#123;sslsocket,&#123;gen_tcp,#Port&lt;0.17851&gt;,tls_connection,&lt;0.533.0&gt;&#125;,&lt;0.6628.124&gt;&#125;&#125;&#125;</span><br><span class="line">## Payload Data</span><br><span class="line">websocket:request:53 [mfa:proc_lib:init_p/5] parse_frames:&#123;ssl,hybi,&lt;&lt;190,209,15&gt;&gt;,&#123;ssl,&#123;sslsocket,&#123;gen_tcp,#Port&lt;0.17851&gt;,tls_connection,&lt;0.533.0&gt;&#125;,&lt;0.6628.124&gt;&#125;&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>对应的协议格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> 0                   1                   2                   3</span><br><span class="line"> 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span><br><span class="line">+-+-+-+-+-------+-+-------------+-------------------------------+</span><br><span class="line">|F|R|R|R| opcode|M| Payload len |    Extended payload length    |</span><br><span class="line">|I|S|S|S|  (4)  |A|     (7)     |             (16/63)           |</span><br><span class="line">|N|V|V|V|       |S|             |   (if payload len==126/127)   |</span><br><span class="line">| |1|2|3|       |K|             |                               |</span><br><span class="line">+-+-+-+-+-------+-+-------------+ - - - - - - - - - - - - - - - +</span><br><span class="line">|     Extended payload length continued, if payload len == 127  |</span><br><span class="line">+ - - - - - - - - - - - - - - - +-------------------------------+</span><br><span class="line">|                               |Masking-key, if MASK set to 1  |</span><br><span class="line">+-------------------------------+-------------------------------+</span><br><span class="line">| Masking-key (continued)       |          Payload Data         |</span><br><span class="line">+-------------------------------- - - - - - - - - - - - - - - - +</span><br><span class="line">:                     Payload Data continued ...                :</span><br><span class="line">+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +</span><br><span class="line">|                     Payload Data continued ...                |</span><br><span class="line">+---------------------------------------------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>对于使用mochiweb的websocket只要增加</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">parse_hybi_frames(_, &lt;&lt;&gt;&gt;, Acc) -&gt;</span><br><span class="line">    lists:reverse(Acc);</span><br><span class="line"></span><br><span class="line">......此处省略N行</span><br><span class="line"></span><br><span class="line">%% 数据不完整，继续收</span><br><span class="line">parse_hybi_frames(Socket, PartFrame, Acc) -&gt;</span><br><span class="line">    %%  io:format(&quot;3 ~p ~n&quot;,[&#123;_Fin,_Rsv,_Opcode,_Mask,_PayloadLen,_MaskKey&#125;]),</span><br><span class="line">    ok = mochiweb_socket:exit_if_closed(mochiweb_socket:setopts(Socket, [&#123;packet, 0&#125;, &#123;active, once&#125;])),</span><br><span class="line">    receive</span><br><span class="line">        &#123;tcp_closed, _&#125; -&gt;</span><br><span class="line">            mochiweb_socket:close(Socket),</span><br><span class="line">            exit(normal);</span><br><span class="line">        &#123;ssl_closed, _&#125; -&gt;</span><br><span class="line">            mochiweb_socket:close(Socket),</span><br><span class="line">            exit(normal);</span><br><span class="line">        &#123;tcp_error, _, _&#125; -&gt;</span><br><span class="line">            mochiweb_socket:close(Socket),</span><br><span class="line">            exit(normal);</span><br><span class="line">        &#123;Proto, _, Continuation&#125; when Proto =:= tcp orelse Proto =:= ssl -&gt;</span><br><span class="line">            parse_hybi_frames(Socket, &lt;&lt;PartFrame/binary, Continuation/binary&gt;&gt;,</span><br><span class="line">                Acc);</span><br><span class="line">        _ -&gt;</span><br><span class="line">            mochiweb_socket:close(Socket),</span><br><span class="line">            exit(normal)</span><br><span class="line">    after</span><br><span class="line">        5000 -&gt;</span><br><span class="line">            mochiweb_socket:close(Socket),</span><br><span class="line">            exit(normal)</span><br><span class="line">    end.</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>其他语言也差不多的逻辑，数据不全就继续等待数据了</p><h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><ol><li><a href="https://datatracker.ietf.org/doc/html/draft-ietf-hybi-thewebsocketprotocol-10">https://datatracker.ietf.org/doc/html/draft-ietf-hybi-thewebsocketprotocol-10</a></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="erlang" scheme="https://www.mingilin.com/categories/erlang/"/>
    
    
    <category term="erlang" scheme="https://www.mingilin.com/tags/erlang/"/>
    
  </entry>
  
  <entry>
    <title>运行中的mongo减少内存占用</title>
    <link href="https://www.mingilin.com/2021/09/17/centos/centos-mongo-memory/"/>
    <id>https://www.mingilin.com/2021/09/17/centos/centos-mongo-memory/</id>
    <published>2021-09-17T09:17:07.000Z</published>
    <updated>2021-09-17T10:55:24.485Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>最近查看公司机器的内存占用情况，发现mongod大约占了50%的内存。<br>命令：<code>ps auxc|head -1;ps auxc|grep -v PID|sort -rn -k +4|head;</code><br>原来<code>内存默认使用的是(系统内存-1GB)*50%</code>（据说是3.4版本+）。</p><p>这也太坑了，服务器又不是专门用作DB的，还有其他进程也要吃内存。</p><p>运行中的mongod，也不敢restart，查询了可能的运行中清理内存。<br><font color=red>注意：没有在正式环境中执行过，仅作参考。</font></p><span id="more"></span><h3 id="方法1-这个应该可以"><a href="#方法1-这个应该可以" class="headerlink" title="方法1(这个应该可以)"></a>方法1(这个应该可以)</h3><p>关闭所有的数据库:<br><code>db.adminCommand(&#123;closeAllDatabases: 1&#125;)</code><br>或者<code>use admin; db.runCommand(&#123;closeAllDatabases: 1&#125;)</code></p><p>使用<code>crontab</code>定时执行<code>mongo --eval &quot;db.adminCommand(&#123;closeAllDatabases: 1&#125;)&quot;</code>?也许可以</p><blockquote><p>有新的数据进来的话,会重新开数据库的</p></blockquote><h3 id="方法2-没试过-不知道进程是否会重启"><a href="#方法2-没试过-不知道进程是否会重启" class="headerlink" title="方法2(没试过,不知道进程是否会重启)"></a>方法2(没试过,不知道进程是否会重启)</h3><p>要安装<code>cgroups</code>，正式环境中没有，没试过，不清楚进程会不会重启</p><ol><li><code>cgcreate -g memory:DBLimitedGroup</code> </li><li><code>echo 16G &gt; /sys/fs/cgroup/memory/DBLimitedGroup/memory.limit_in_bytes</code></li><li><code>sync; echo 3 &gt; /proc/sys/vm/drop_caches</code></li><li><code>cgclassify -g memory:DBLimitedGroup $(pidof mongod)</code></li></ol><h3 id="方法3-应该要重启的，没有试过"><a href="#方法3-应该要重启的，没有试过" class="headerlink" title="方法3(应该要重启的，没有试过)"></a>方法3(应该要重启的，没有试过)</h3><p><code>mongod.conf</code>增加<code>wiredTigerCacheSizeGB=8</code>，然后<code>mongod reload</code><br>或者<br><code>/usr/bin/mongod --config /etc/mongod.conf --fork --wiredTigerCacheSizeGB 8</code></p><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ol><li><a href="https://www.techpaste.com/2016/04/limit-mongodb-memory-usage/">https://www.techpaste.com/2016/04/limit-mongodb-memory-usage/</a></li><li><a href="https://www.cnblogs.com/On-my-way/p/9708225.html">https://www.cnblogs.com/On-my-way/p/9708225.html</a></li><li><a href="https://www.cnblogs.com/wt11/p/9291583.html">https://www.cnblogs.com/wt11/p/9291583.html</a></li><li><a href="https://stackoverflow.com/questions/6861184/is-there-any-option-to-limit-mongodb-memory-usage">https://stackoverflow.com/questions/6861184/is-there-any-option-to-limit-mongodb-memory-usage</a></li><li><a href="https://mongodb-documentation.readthedocs.io/en/latest/reference/command/listDatabases.html#gsc.tab=0">https://mongodb-documentation.readthedocs.io/en/latest/reference/command/listDatabases.html#gsc.tab=0</a></li><li><a href="https://segmentfault.com/q/1010000002953588">https://segmentfault.com/q/1010000002953588</a></li></ol>]]></content>
    
    
    <summary type="html">&lt;p&gt;最近查看公司机器的内存占用情况，发现mongod大约占了50%的内存。&lt;br&gt;命令：&lt;code&gt;ps auxc|head -1;ps auxc|grep -v PID|sort -rn -k +4|head;&lt;/code&gt;&lt;br&gt;原来&lt;code&gt;内存默认使用的是(系统内存-1GB)*50%&lt;/code&gt;（据说是3.4版本+）。&lt;/p&gt;
&lt;p&gt;这也太坑了，服务器又不是专门用作DB的，还有其他进程也要吃内存。&lt;/p&gt;
&lt;p&gt;运行中的mongod，也不敢restart，查询了可能的运行中清理内存。&lt;br&gt;&lt;font color=red&gt;注意：没有在正式环境中执行过，仅作参考。&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="centos" scheme="https://www.mingilin.com/categories/centos/"/>
    
    <category term="mongo" scheme="https://www.mingilin.com/categories/centos/mongo/"/>
    
    
    <category term="centos" scheme="https://www.mingilin.com/tags/centos/"/>
    
    <category term="mongo" scheme="https://www.mingilin.com/tags/mongo/"/>
    
  </entry>
  
  <entry>
    <title>共享Android手机上的音视频到智能电视上</title>
    <link href="https://www.mingilin.com/2021/08/13/mobile/mobile-dlna-server/"/>
    <id>https://www.mingilin.com/2021/08/13/mobile/mobile-dlna-server/</id>
    <published>2021-08-13T06:00:00.000Z</published>
    <updated>2021-08-13T06:32:04.031Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="server端"><a href="#server端" class="headerlink" title="server端"></a><code>server端</code></h2><p>下载地址:</p><ul><li><a href="https://play.google.com/store/apps/details?id=com.al.dlnaserver">[fq]Google Play</a></li><li><a href="https://apkpure.com/cn/dlnaserver/com.al.dlnaserver">[fq]ApkPure</a></li><li><a href="/downloads/binary/DLNAServer_v2.14_apkpure.com.apk">本地下载</a></li></ul><p>安装到自己的手机上，然后点击右上角的+，添加需要共享的视频/音频<br>确保可以后台运行</p><h2 id="client端"><a href="#client端" class="headerlink" title="client端"></a><code>client端</code></h2><p>下载<a href="https://www.videolan.org/vlc/download-android.html">VLC for Android</a><br>安装到<code>某盒子</code>或者<code>智能电视</code>上<br>确保<code>server端</code>和<code>client端</code>在同一个局域网中</p><p>打开VLC，稍等片刻就可以在<code>本地网络</code>中看到了<br>如果看不到的话,就<code>重启</code>下server端</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="手机" scheme="https://www.mingilin.com/categories/%E6%89%8B%E6%9C%BA/"/>
    
    
    <category term="手机" scheme="https://www.mingilin.com/tags/%E6%89%8B%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>农历公历转换</title>
    <link href="https://www.mingilin.com/2021/08/09/other/other-lunar2solar/"/>
    <id>https://www.mingilin.com/2021/08/09/other/other-lunar2solar/</id>
    <published>2021-08-09T00:00:00.000Z</published>
    <updated>2021-08-09T07:41:53.710Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>农历转公历是没有规律的，所以只能根据已有的数据转换</strong><br>香港天文台的数据：<a href="https://www.hko.gov.hk/tc/gts/time/conversion1_text.htm#">https://www.hko.gov.hk/tc/gts/time/conversion1_text.htm#</a></p><p>自己转换出了一个<code>lunar.db</code><a href="/downloads/binary/lunar.db">(点击下载)</a>，用<code>sqilte3</code>打开</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash">sqlite3 lunar.db <span class="string">&quot;SELECT solar from lunar2solar where lunar=\&quot;2023-02-22\&quot;&quot;</span></span></span><br><span class="line">2023-03-13</span><br><span class="line">2023-04-12</span><br></pre></td></tr></table></figure><p>自己随便写了一个农历转公历的接口，其实就是从<code>lunar.db</code>中查询数据而已<br>很随意的，性能没法保证的<br><code>https://tools.web.mingilin.com/lunar2solar/lunar2solar.php?lunar=2023-02-22</code><br>日期格式必须是YYYY-MM-DD</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ curl --silent https://tools.web.mingilin.com/lunar2solar/lunar2solar.php?lunar=2023-02-22 | jq -r <span class="string">&#x27;.data | .[].solar&#x27;</span></span><br><span class="line">2023-03-13</span><br><span class="line">2023-04-12</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="other" scheme="https://www.mingilin.com/categories/other/"/>
    
    
    <category term="other" scheme="https://www.mingilin.com/tags/other/"/>
    
  </entry>
  
  <entry>
    <title>Win10下git clone ssh免密</title>
    <link href="https://www.mingilin.com/2021/08/08/windows/windows-git-clone-nopass/"/>
    <id>https://www.mingilin.com/2021/08/08/windows/windows-git-clone-nopass/</id>
    <published>2021-08-08T10:00:00.000Z</published>
    <updated>2021-08-09T07:21:58.470Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="git-for-windows"><a href="#git-for-windows" class="headerlink" title="git for windows"></a><code>git for windows</code></h2><ol><li>启动<code>ssh-agent</code>服务<ol><li><code>Win+s</code>搜索<code>服务</code>,以管理员身份运行</li><li>设置<code>OpenSSH Authentication Agent</code>为开机启动</li></ol></li><li><code>ssh-add</code>增加私钥<br>私钥放到<code>C:\Users\用户名</code>目录下,<code>ssh-add %USERPROFILE%\ssh_keys\id_rsa</code><br>可以创建一个开机启动.bat(<code>Win+R</code>-&gt;<code>shell:startup</code>)<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 启动win10_ssh-agent</span><br><span class="line"><span class="built_in">echo</span> 环境变量增加GIT_SSH=C:\WINDOWS\System32\OpenSSH\ssh.exe</span><br><span class="line"><span class="function">C:\<span class="title">WINDOWS</span>\<span class="title">System32</span>\<span class="title">OpenSSH</span>\<span class="title">ssh</span>-<span class="title">agent.exe</span></span></span><br><span class="line"><span class="function"><span class="title">ssh</span>-<span class="title">add</span> %<span class="title">USERPROFILE</span>%\<span class="title">ssh_keys</span>\<span class="title">id_rsa</span></span></span><br><span class="line"><span class="function"><span class="title">ssh</span>-<span class="title">add</span> %<span class="title">USERPROFILE</span>%\<span class="title">ssh_keys</span>\<span class="title">id_rsa2</span></span></span><br></pre></td></tr></table></figure></li><li>修改git配置<ol><li><code>Win+s</code>搜索<code>编辑系统环境变量</code></li><li>增加系统环境变量<code>GIT_SSH=C:\WINDOWS\System32\OpenSSH\ssh.exe</code></li></ol></li><li>完成<br><code>git clone ssh://xxx</code>应该就可以正常工作了</li></ol><h2 id="TortoiseGIT"><a href="#TortoiseGIT" class="headerlink" title="TortoiseGIT"></a><code>TortoiseGIT</code></h2><ol><li>方法1:<ol><li>先设置好<code>git for windows</code></li><li>修改配置(<code>Settings</code> -&gt; <code>Network</code> -&gt; <code>SSH Client</code>)<br>修改为<code>C:\WINDOWS\System32\OpenSSH\ssh.exe</code></li></ol></li><li>方法2:<ol><li>启动<code>Pageant</code>，添加私钥.ppk</li><li>修改配置(<code>Settings</code> -&gt; <code>Network</code> -&gt; <code>SSH Client</code>)<br>修改为<code>Your\TortoiseGit\Path\bin\TortoisePlink.exe</code></li></ol></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="windows" scheme="https://www.mingilin.com/categories/windows/"/>
    
    
    <category term="windows" scheme="https://www.mingilin.com/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>【转】DAVx5无法开启OpenTasks/Tasks.org权限的问题</title>
    <link href="https://www.mingilin.com/2021/07/30/other/other-davx5-sync/"/>
    <id>https://www.mingilin.com/2021/07/30/other/other-davx5-sync/</id>
    <published>2021-07-30T10:00:00.000Z</published>
    <updated>2021-07-30T10:16:30.455Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><div class="tabs" id="tab"><ul class="nav-tabs"><li class="tab active"><a href="#tab-1">原文</a></li><li class="tab"><a href="#tab-2">附加</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab-1"><blockquote><p>原文链接: <a href="https://blog.wanfajie.com/2021/02/566">https://blog.wanfajie.com/2021/02/566</a></p></blockquote><p>小米6手机（MIUI 11 20.1.16）中使用 DAVx5 显示缺少权限、无法同步 Tasks/OpenTasks 中任务。并且在 “设置” -&gt; “应用权限” 中点击 “OpenTasks权限”/“Tasks权限” 开关无法打开。查看 DAVx5 日志发现以下四项权限被禁止：</p><ul><li>org.dmfs.permission.READ_TASKS: denied</li><li>org.dmfs.permission.WRITE_TASKS: denied</li><li>org.tasks.permission.READ_TASKS: denied</li><li>org.tasks.permission.WRITE_TASKS: denied</li></ul><p>令人困惑的是，MIUI 既不给出授权提示，在权限管理中也找不到自定义应用权限授权的地方。对 MIUI 的“设置”地毯式搜索后，终于找到了解决方法。</p><ol><li>首先安装好 DAVx5 及 OpenTasks/Tasks.org 应用。</li><li>在“全部参数”中点击5次“MIUI 版本”，开启开发者模式。</li><li>在“开发者选项”中，关闭位于最下面的几个选项中的“启用MIUI优化”。</li><li>回到桌面，长按 DAVx5 应用的图标，点击“应用信息”。<br>P.S.: 此时，应用信息界面变了个样子。如果是通过“设置”进入“应用信息”的话，界面将保持 MIUI 的原状。</li><li>然后，点击“应用信息”界面中的“权限”。进入“应用权限”界面后，你会在最下方看到“其他权限”选项。</li><li>进入“其他权限”，权限列表中将出现 “Tasks” 之类的权限，打开权限开关。<br>进入 DAVx5 的 “设置” -&gt; “应用权限”，此时就可以开启 “OpenTasks权限”/“Tasks权限” 开关并正常同步 OpenTasks 中的数据。</li></ol><p>最后，建议再重新开启“启用MIUI优化”。关闭优化后，许多设置像是重置了一样，一来重新设置嫌麻烦，二来开启MIUI优化手机使用起来于我而言也没什么不足。网络上对MIUI优化众说纷纭，就看各位自行判断了。</p></div><div class="tab-pane" id="tab-2"><ol><li>在<code>Google Play</code>上<code>DAVx5</code>需要米，在<a href="https://f-droid.org/"><code>F-Droid</code></a>免费；</li><li>按照原文的方法，第一次重新“开启MIUI优化”后，<code>DAVx5</code>权限被重置了，<br>又重新关闭再开启，<code>DAVx5</code>可以用了，<br>可能成功与否要看人品；</li><li><code>Tasks.org</code>需要订购后才能使用<code>DAVx5</code>同步，没米，果断放弃，用<code>OpenTasks</code>；</li><li>使用<a href="https://radicale.org/3.0.html"><code>Radicale</code></a>自建<code>CalDAV</code>和<code>CardDAV</code>Server，真香，<br>如果配合docker就更香；</li><li>PC上用<code>Thunder Bird</code>+<code>TbSync</code>插件，管理日程和联系人；</li></ol></div></div></div>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="other" scheme="https://www.mingilin.com/categories/other/"/>
    
    
    <category term="other" scheme="https://www.mingilin.com/tags/other/"/>
    
  </entry>
  
  <entry>
    <title>Termux(Android)配置</title>
    <link href="https://www.mingilin.com/2021/07/29/centos/centos-termux/"/>
    <id>https://www.mingilin.com/2021/07/29/centos/centos-termux/</id>
    <published>2021-07-29T10:00:00.000Z</published>
    <updated>2021-07-30T01:14:01.207Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>最近要接手一些运维的工作<br>有时候需要远程更新下<br>对比了几个安卓的ssh客户端,发现<code>termux</code>最好用了(可以很方便的将迁移sessions)(<code>Termius</code>也挺好的)</p><span id="more"></span><h2 id="修改源"><a href="#修改源" class="headerlink" title="修改源"></a>修改源</h2><p><code>termux-change-repo</code></p><h2 id="根目录地址"><a href="#根目录地址" class="headerlink" title="根目录地址"></a>根目录地址</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">echo</span> <span class="variable">$PREFIX</span></span></span><br><span class="line">/data/data/com.termux/files/usr</span><br></pre></td></tr></table></figure><h2 id="安装sshd服务"><a href="#安装sshd服务" class="headerlink" title="安装sshd服务"></a>安装<code>sshd</code>服务</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pkg install termux-services</span><br><span class="line">pkg install openssh</span><br><span class="line">sv-enable sshd</span><br><span class="line">sv start sshd</span><br></pre></td></tr></table></figure><p>默认端口 <code>8022</code><br>现在就可以用ssh登录了,用<code>sftp</code>发送文件了</p><h2 id="设置Termux软键盘"><a href="#设置Termux软键盘" class="headerlink" title="设置Termux软键盘"></a>设置Termux软键盘</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ~/.termux/termux.properties</span></span></span><br><span class="line">extra-keys = [ \</span><br><span class="line"> [&#x27;|&#x27;, &#x27;~&#x27;, &#x27;/&#x27;, &#x27;.&#x27;, &#x27;-&#x27;, &#x27;_&#x27;, &#x27;ENTER&#x27;], \</span><br><span class="line"> [&#x27;ESC&#x27;, &#x27;TAB&#x27;, &#x27;HOME&#x27;,&#x27;UP&#x27;,&#x27;END&#x27;,&#x27;DEL&#x27;, &#x27;exit&#x27;], \</span><br><span class="line"> [&#x27;CTRL&#x27;,&#x27;ALT&#x27;,&#x27;LEFT&#x27;,&#x27;DOWN&#x27;,&#x27;RIGHT&#x27;, &#x27;BKSP&#x27;, &#x27;KEYBOARD&#x27;] \</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><ul><li>grep 中文问题<br><a href="https://unix.stackexchange.com/questions/580139/termux-grep-fails-to-detect-chinese-character">相同问题的链接</a>, 解决方式:<code>pkg install busybox</code>, 使用<code>busybox grep</code></li></ul><h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><ol><li><a href="https://mirrors.tuna.tsinghua.edu.cn/help/termux/">https://mirrors.tuna.tsinghua.edu.cn/help/termux/</a></li><li><a href="https://wiki.termux.com/wiki/Termux-services">https://wiki.termux.com/wiki/Termux-services</a></li><li><a href="https://wiki.termux.com/wiki/Touch_Keyboard">https://wiki.termux.com/wiki/Touch_Keyboard</a></li></ol><h2 id="附带自动生成的远程登录的脚本"><a href="#附带自动生成的远程登录的脚本" class="headerlink" title="附带自动生成的远程登录的脚本"></a>附带自动生成的远程登录的脚本</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">eval &quot;$(curl --silent https://www.mingilin.com/downloads/code/printcolor.sh)&quot;</span><br><span class="line">CACHE_DIR=~/.cache/</span><br><span class="line">mkdir -p $CACHE_DIR</span><br><span class="line">CFG_FILE=$&#123;CACHE_DIR&#125;/ssh_test_cfg.cfg</span><br><span class="line">if [ &quot;$(uname -o)&quot; == &quot;Android&quot; ];then</span><br><span class="line">    GREP=&quot;busybox grep&quot;</span><br><span class="line">else</span><br><span class="line">    GREP=grep</span><br><span class="line">fi</span><br><span class="line">MYSSH_KEY_DIR=~/myssh</span><br><span class="line">cat &gt; $CFG_FILE &lt;&lt;EOF</span><br><span class="line">&#123;&quot;id&quot;:&quot;7&quot;, &quot;group&quot;:[&quot;&quot;,&quot;0. 内网机器&quot;], &quot;name&quot;:&quot;DNS服务器-192.168.50.12&quot;, &quot;user&quot;:&quot;root&quot;, &quot;host&quot;:&quot;192.168.50.12&quot;, &quot;port&quot;:&quot;9022&quot;&#125;</span><br><span class="line">&#123;&quot;id&quot;:&quot;63&quot;, &quot;group&quot;:[&quot;&quot;,&quot;Z101. vagrant&quot;], &quot;name&quot;:&quot;192.168.56.10&quot;, &quot;user&quot;:&quot;root&quot;, &quot;host&quot;:&quot;192.168.56.10&quot;, &quot;port&quot;:&quot;22&quot;&#125;</span><br><span class="line">&#123;&quot;id&quot;:&quot;64&quot;, &quot;group&quot;:[&quot;&quot;,&quot;Z101. vagrant&quot;], &quot;name&quot;:&quot;192.168.56.11&quot;, &quot;user&quot;:&quot;root&quot;, &quot;host&quot;:&quot;192.168.56.11&quot;, &quot;port&quot;:&quot;22&quot;&#125;</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">function show_list() &#123;</span><br><span class="line">    filter=$1</span><br><span class="line">    group=&quot;&quot;</span><br><span class="line">    while read line_t; do</span><br><span class="line">        if [ &quot;$filter&quot; == &quot;&quot; ]; then</span><br><span class="line">            line=$line_t</span><br><span class="line">        else</span><br><span class="line">            line=$(echo $line_t | $&#123;GREP&#125; &quot;$filter&quot;)</span><br><span class="line">        fi</span><br><span class="line">        if [ &quot;$line&quot; == &quot;&quot; ]; then</span><br><span class="line">            continue</span><br><span class="line">        fi</span><br><span class="line">        group1=$(echo $line | jq &#x27;.group | join(&quot;&quot;)&#x27;)</span><br><span class="line">        port=$(echo $line | jq .port | sed &#x27;s/&quot;//g&#x27;)</span><br><span class="line">        if [ &quot;$port&quot; == &quot;0&quot; ]; then</span><br><span class="line">            continue</span><br><span class="line">        fi</span><br><span class="line">        if [ &quot;$group&quot; == &quot;$group1&quot; ]; then</span><br><span class="line">            echo -n &quot; &quot;</span><br><span class="line">            echo $line | jq &#x27;[.id,.name] | join(&quot; ===&gt; &quot;)&#x27; | sed &#x27;s/&quot;//g&#x27;</span><br><span class="line">        else</span><br><span class="line">            group=$group1</span><br><span class="line">            echo &quot;&quot;</span><br><span class="line">            print_info &quot;=======================================================&quot;</span><br><span class="line">            _print_info &quot;&gt;&gt;&gt; &quot;</span><br><span class="line">            print_info $(echo $line | jq -r &#x27;.group | .[1:] | join(&quot; &gt; &quot;)&#x27;)</span><br><span class="line">            print_info &quot;-------------------------------------------------------&quot;</span><br><span class="line">            echo -n &quot; &quot;</span><br><span class="line">            echo $line | jq -r &#x27;[.id,.name] | join(&quot; ===&gt; &quot;)&#x27;</span><br><span class="line">        fi</span><br><span class="line">    done &lt; $CFG_FILE</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function login() &#123;</span><br><span class="line">    id=$1</span><br><span class="line">    line=$(cat $CFG_FILE | $&#123;GREP&#125; &quot;\&quot;id\&quot;:\&quot;$id\&quot;&quot;)</span><br><span class="line">    sshhost=$(echo $line | jq -r .host)</span><br><span class="line">    sshport=$(echo $line | jq -r .port)</span><br><span class="line">    sshuser=$(echo $line | jq -r .user)</span><br><span class="line">    print_info &quot;===&gt; login $sshuser@$sshhost port:$sshport&quot;</span><br><span class="line">    ssh -o GSSAPIAuthentication=no -o StrictHostKeyChecking=no -p $sshport $sshuser@$sshhost</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function start_sshagent() &#123;</span><br><span class="line">    [ ! -d $MYSSH_KEY_DIR ] &amp;&amp; echo &quot;[error] not found dir: $MYSSH_KEY_DIR&quot; &amp;&amp; exit</span><br><span class="line"></span><br><span class="line">    eval $(ssh-agent)</span><br><span class="line">    for i in $(find $MYSSH_KEY_DIR -type f); do</span><br><span class="line">        ssh-add -q $i</span><br><span class="line">    done</span><br><span class="line">    ssh-add -l</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function stop_sshagent() &#123;</span><br><span class="line">    eval $(ssh-agent -k)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function help() &#123;</span><br><span class="line">    print_info &quot;=======================================&quot;</span><br><span class="line">    print_info &quot;show_list         - list all sessions  &quot;</span><br><span class="line">    print_info &quot;show_list group   - list group sessions&quot;</span><br><span class="line">    print_info &quot;login id          - login&quot;</span><br><span class="line">    print_info &quot;=======================================&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">case $1 in</span><br><span class="line">    &quot;login&quot;)</span><br><span class="line">        start_sshagent</span><br><span class="line">        login $2</span><br><span class="line">        stop_sshagent</span><br><span class="line">        ;;</span><br><span class="line">    &quot;show_list&quot;)</span><br><span class="line">        show_list $2</span><br><span class="line">        ;;</span><br><span class="line">    *) </span><br><span class="line">        help</span><br><span class="line">        ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;最近要接手一些运维的工作&lt;br&gt;有时候需要远程更新下&lt;br&gt;对比了几个安卓的ssh客户端,发现&lt;code&gt;termux&lt;/code&gt;最好用了(可以很方便的将迁移sessions)(&lt;code&gt;Termius&lt;/code&gt;也挺好的)&lt;/p&gt;</summary>
    
    
    
    <category term="termux" scheme="https://www.mingilin.com/categories/termux/"/>
    
    
    <category term="termux" scheme="https://www.mingilin.com/tags/termux/"/>
    
  </entry>
  
  <entry>
    <title>screen</title>
    <link href="https://www.mingilin.com/2021/07/04/centos/centos-screentool/"/>
    <id>https://www.mingilin.com/2021/07/04/centos/centos-screentool/</id>
    <published>2021-07-04T03:30:00.000Z</published>
    <updated>2021-07-06T08:49:58.433Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>个人经常使用的是<code>tmux</code>, 使用<code>tmuxinator</code>管理session</p><p>现在需要接手一些运维工作，但是默认安装的是<code>screen</code>，因此需要一些<code>screen</code>的知识</p><p>用惯了<code>tmuxinator</code>，也想使用类似的工具管理<code>screen</code>的session</p><blockquote><p>其实就是简单的生成不同的<code>screenrc</code>配置，使用<code>screen -c xxx.rc</code>调用不同的配置</p></blockquote><div class="tabs" id="tab"><ul class="nav-tabs"><li class="tab active"><a href="#tab-1">效果图</a></li><li class="tab"><a href="#tab-2">HELP</a></li><li class="tab"><a href="#tab-3">源码</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab-1"><p><img src="/downloads/assets/screentool.png" alt="效果图"></p></div><div class="tab-pane" id="tab-2"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">$ screentool</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;&gt;&gt; COMMAND &lt;&lt;&lt;&lt;&lt;</span><br><span class="line">new session      # create new session</span><br><span class="line">ls               # list all session</span><br><span class="line">edit session     # edit session config</span><br><span class="line">rm session       # remove session config</span><br><span class="line">start session    # start session</span><br><span class="line">stop session     # stop session</span><br><span class="line">status session   # status session</span><br><span class="line">install binname  # install screentool</span><br><span class="line">exec session cmd # exec &quot;cmd&quot;(use quotes)</span><br><span class="line">  cmd:</span><br><span class="line">    1. a command(ex. python)</span><br><span class="line">    2. -t python 10 python</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;&gt;&gt; KEYBINDINGS &lt;&lt;&lt;&lt;&lt;</span><br><span class="line">+---------------+---------------------+</span><br><span class="line">| ctrl-a d      | detach              |</span><br><span class="line">| ctrl-a c      | 创建 window         |</span><br><span class="line">| ctrl-a k      | 关闭 window         |</span><br><span class="line">| ctrl-a A      | 重命名 windows      |</span><br><span class="line">| ctrl-a w      | 显示所有窗口        |</span><br><span class="line">|---------------+---------------------|</span><br><span class="line">| ctrl-a 0~9    | 切换窗口            |</span><br><span class="line">| ctrl-a ctrl-a | 快速切换窗口        |</span><br><span class="line">| ctrl-a Tab    | 切换到另一个(分屏)  |</span><br><span class="line">| ctrl-a p      | prev window         |</span><br><span class="line">| ctrl-a n      | next window         |</span><br><span class="line">|---------------+---------------------|</span><br><span class="line">| ctrl-a S      | 水平分屏            |</span><br><span class="line">| ctrl-a |      | 垂直分屏            |</span><br><span class="line">| ctrl-a Q      | 去除分屏            |</span><br><span class="line">|---------------+---------------------|</span><br><span class="line">| ctrl-a [      | copy                |</span><br><span class="line">|               | 空格是开始/结束选择 |</span><br><span class="line">| ctrl-a ]      | paste               |</span><br><span class="line">+---------------+---------------------+</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="tab-3"><p>附带<a href="/downloads/code/screentool/myscreen"><code>源码</code></a></p></div></div></div>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="centos" scheme="https://www.mingilin.com/categories/centos/"/>
    
    <category term="linux" scheme="https://www.mingilin.com/categories/centos/linux/"/>
    
    
    <category term="screen" scheme="https://www.mingilin.com/tags/screen/"/>
    
  </entry>
  
  <entry>
    <title>推荐两个安卓下的桌面股票插件</title>
    <link href="https://www.mingilin.com/2020/12/04/other/other-deskstock-android/"/>
    <id>https://www.mingilin.com/2020/12/04/other/other-deskstock-android/</id>
    <published>2020-12-04T08:07:42.000Z</published>
    <updated>2021-07-06T08:26:23.600Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/downloads/assets/deskstock.jpg" alt="效果图"></p><p>上面是：<a href="https://play.google.com/store/apps/details?id=top.ministock"><strong>桌面股票</strong></a><br>下面是：<a href="https://play.google.com/store/apps/details?id=com.virsir.android.smartstockcn"><strong>机灵股票</strong></a></p><p>插件是极好的，就是股票不赚钱😂<br>原来<code>股票精灵</code>挺好用的，现在已经废掉了😂</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="other" scheme="https://www.mingilin.com/categories/other/"/>
    
    
    <category term="other" scheme="https://www.mingilin.com/tags/other/"/>
    
  </entry>
  
  <entry>
    <title>自用的NGINX+MYSQL+PHP集成环境</title>
    <link href="https://www.mingilin.com/2020/12/04/other/other-mywnmp/"/>
    <id>https://www.mingilin.com/2020/12/04/other/other-mywnmp/</id>
    <published>2020-12-04T07:36:00.000Z</published>
    <updated>2021-07-06T08:26:23.607Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>分享一个自用的web集成环境<br>在其他人的基础上修改的，现在实在找不到是在哪个基础上修改的，抱歉<br>只要有点开发基础，就可以快速的自定义组件，目前包括：</p><ul><li>NGINX + PHP + MYSQL</li><li>MONGO</li><li>REDIS + MEMCACHED</li><li>XLIGHT(FTP SERVER)</li><li>OpenSSH-Win64</li></ul><p>链接: <a href="https://pan.baidu.com/s/1xi2MzcR6P7lNrQ3JItYXUQ">https://pan.baidu.com/s/1xi2MzcR6P7lNrQ3JItYXUQ</a> 提取码: w15d<br><img src="/downloads/assets/mywnmp_qrcode.jpg" alt="二维码"> </p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="other" scheme="https://www.mingilin.com/categories/other/"/>
    
    
    <category term="other" scheme="https://www.mingilin.com/tags/other/"/>
    
  </entry>
  
  <entry>
    <title>ERLANG解决“证书出错，请登录微信支付商户平台下载证书”</title>
    <link href="https://www.mingilin.com/2020/12/04/erlang/erlang-wx-pay/"/>
    <id>https://www.mingilin.com/2020/12/04/erlang/erlang-wx-pay/</id>
    <published>2020-12-04T06:55:00.000Z</published>
    <updated>2021-07-06T08:26:23.591Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="解决“证书出错，请登录微信支付商户平台下载证书”的核心代码"><a href="#解决“证书出错，请登录微信支付商户平台下载证书”的核心代码" class="headerlink" title="解决“证书出错，请登录微信支付商户平台下载证书”的核心代码"></a>解决“证书出错，请登录微信支付商户平台下载证书”的核心代码</h3><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">request_post</span><span class="params">(Url, Path, &#123;data, Str&#125;)</span> -&gt;</span></span><br><span class="line">    ReqUrl = lists:concat([Url, Path]),</span><br><span class="line">    <span class="comment">%% +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line">    <span class="comment">%% 😊这个是核心的核心😊</span></span><br><span class="line">    SSLOptions = [</span><br><span class="line">        &#123;keyfile,<span class="string">&quot;apiclient_key.pem&quot;</span>&#125;,</span><br><span class="line">        &#123;certfile,<span class="string">&quot;apiclient_cert.pem&quot;</span>&#125;</span><br><span class="line">    ],</span><br><span class="line">    HTTPOptions = [&#123;ssl, SSLOptions&#125;, &#123;timeout, <span class="number">5000</span>&#125;, &#123;version, <span class="string">&quot;HTTP/1.1&quot;</span>&#125;],</span><br><span class="line">    <span class="comment">%% +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line">    Request = &#123;ReqUrl, [], <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>, iolist_to_binary(Str)&#125;,</span><br><span class="line">    httpc:request(post, Request, HTTPOptions, []).</span><br></pre></td></tr></table></figure><span id="more"></span><h3 id="使用xmerl解析xml"><a href="#使用xmerl解析xml" class="headerlink" title="使用xmerl解析xml"></a>使用<code>xmerl</code>解析xml</h3><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">scan_str</span><span class="params">(Str)</span> -&gt;</span></span><br><span class="line">    &#123;XmlElement, _Rest&#125; = xmerl_scan:string(Str, [&#123;space, normalize&#125;]),</span><br><span class="line">    [XmlElement1] = xmerl_lib:remove_whitespace([XmlElement]),</span><br><span class="line">    XmlElement1.</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">value_of</span><span class="params">(Key, #xmlElement&#123;&#125; = X)</span> -&gt;</span></span><br><span class="line">    <span class="keyword">case</span> xmerl_xs:select(Key, X) <span class="keyword">of</span></span><br><span class="line">        [#xmlElement&#123;&#125; = Find] -&gt;</span><br><span class="line">            de_cdata(xmerl_xs:value_of(Find));</span><br><span class="line">        [] -&gt;</span><br><span class="line">            []</span><br><span class="line">    <span class="keyword">end</span>.</span><br><span class="line"><span class="function"><span class="title">de_cdata</span><span class="params">(<span class="string">&quot;![CDATA[&quot;</span> ++ Data)</span> -&gt;</span></span><br><span class="line">    [_,_|Data1] = lists:reverse(Data),</span><br><span class="line">    unescape_str(lists:reverse(Data1));</span><br><span class="line"><span class="function"><span class="title">de_cdata</span><span class="params">(Data)</span> -&gt;</span></span><br><span class="line">    unescape_str(Data).</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">unescape_str</span><span class="params">(Str)</span> -&gt;</span></span><br><span class="line">    Str1 = unicode:characters_to_binary(Str),</span><br><span class="line">    GtEsc  = re:replace(Str1, <span class="string">&quot;&amp;amp;&quot;</span>, <span class="string">&quot;\\&amp;&quot;</span>, [global]),</span><br><span class="line">    LtEsc  = re:replace(GtEsc,  <span class="string">&quot;&amp;gt;&quot;</span>,  <span class="string">&quot;&gt;&quot;</span>,   [global]),</span><br><span class="line">    AmpEsc = re:replace(LtEsc,  <span class="string">&quot;&amp;lt;&quot;</span>,  <span class="string">&quot;&lt;&quot;</span>,   [global]),</span><br><span class="line">    Text   = re:replace(AmpEsc, <span class="string">&quot;&amp;amp;&quot;</span>, <span class="string">&quot;\\&amp;&quot;</span>, [global]),</span><br><span class="line">    util:to_list(Text).</span><br></pre></td></tr></table></figure><h3 id="将proplists转换为xml"><a href="#将proplists转换为xml" class="headerlink" title="将proplists转换为xml"></a>将<code>proplists</code>转换为xml</h3><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">export_xml</span><span class="params">(List)</span> -&gt;</span></span><br><span class="line">    Fields = lists:map(</span><br><span class="line">               <span class="keyword">fun</span>(&#123;Key, Value&#125;) -&gt;</span><br><span class="line">                       &#123;Key, [], [util:to_list(Value)]&#125;</span><br><span class="line">               <span class="keyword">end</span>, List),</span><br><span class="line">    Xml = xmerl:export_simple([&#123;xml, Fields&#125;], xmerl_xml, [&#123;prolog, <span class="string">&quot;&quot;</span>&#125;]),</span><br><span class="line">    Xml.</span><br></pre></td></tr></table></figure><h3 id="相对完整的逻辑代码"><a href="#相对完整的逻辑代码" class="headerlink" title="相对完整的逻辑代码"></a>相对完整的逻辑代码</h3><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">notice_wx</span><span class="params">(UserName, PlayerId, Amount, OrderNum)</span> -&gt;</span></span><br><span class="line">    <span class="comment">%% 插入日志</span></span><br><span class="line">    insert_extract_log(OrderNum, Amount),</span><br><span class="line"></span><br><span class="line">    Url = <span class="string">&quot;https://api.mch.weixin.qq.com/mmpaymkttransfers/promotion/transfers&quot;</span>,</span><br><span class="line"></span><br><span class="line">    MchAppId = <span class="string">&quot;wx1234567890&quot;</span>,</span><br><span class="line">    MchId = <span class="number">1234567890</span>,</span><br><span class="line">    Key = <span class="string">&quot;key1234567890&quot;</span>,</span><br><span class="line">    Desc = <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="comment">%% 生成随机字符串</span></span><br><span class="line">    RandStr = util:rand_str(<span class="number">16</span>, <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span>),</span><br><span class="line">    DataT = [</span><br><span class="line">            &#123;mch_appid, MchAppId&#125;,</span><br><span class="line">            &#123;mchid, MchId&#125;,</span><br><span class="line">            &#123;device_info, config:server_id()&#125;,</span><br><span class="line">            &#123;nonce_str, RandStr&#125;,</span><br><span class="line">            &#123;partner_trade_no, OrderNum&#125;,</span><br><span class="line">            &#123;openid, UserName&#125;,</span><br><span class="line">            &#123;check_name, <span class="string">&quot;NO_CHECK&quot;</span>&#125;,</span><br><span class="line">            &#123;amount, Amount&#125;,</span><br><span class="line">            &#123;desc, Desc&#125;</span><br><span class="line">           ],</span><br><span class="line">    Data = lists:sort(DataT),</span><br><span class="line">    DataStrList = lists:map( </span><br><span class="line">                    <span class="keyword">fun</span>(&#123;K, V&#125;) -&gt;</span><br><span class="line">                            io_lib:format(<span class="string">&quot;~p=~s&quot;</span>, [K, util:to_list(V)])</span><br><span class="line">                    <span class="keyword">end</span>, Data),</span><br><span class="line">    DataStr1 = string:join(DataStrList, <span class="string">&quot;&amp;&quot;</span>),</span><br><span class="line">    DataStr = lists:concat([DataStr1, <span class="string">&quot;&amp;key=&quot;</span>, Key]),</span><br><span class="line">    Sign = util:md5(DataStr),</span><br><span class="line">    Data1 = [&#123;sign, util:to_upper(Sign)&#125;|Data],</span><br><span class="line">    Str = export_xml(Data1),</span><br><span class="line"></span><br><span class="line">    <span class="comment">%% POST请求</span></span><br><span class="line">    <span class="keyword">case</span> request_post(Url, <span class="string">&quot;&quot;</span>, &#123;data, Str&#125;) <span class="keyword">of</span></span><br><span class="line">        &#123;ok, &#123;&#123;_,<span class="number">200</span>,<span class="string">&quot;OK&quot;</span>&#125;, _, Content&#125;&#125; -&gt;</span><br><span class="line">            Xml = scan_str(Content),</span><br><span class="line">            Val = value_of(<span class="string">&quot;return_code&quot;</span>, Xml),</span><br><span class="line">            <span class="keyword">case</span> Val <span class="keyword">of</span></span><br><span class="line">                <span class="string">&quot;SUCCESS&quot;</span> -&gt; </span><br><span class="line">                    Code = value_of(<span class="string">&quot;result_code&quot;</span>, Xml),</span><br><span class="line">                    <span class="keyword">case</span> Code <span class="keyword">of</span></span><br><span class="line">                        <span class="string">&quot;SUCCESS&quot;</span> -&gt; </span><br><span class="line">                            WxPayNo = value_of(<span class="string">&quot;payment_no&quot;</span>, Xml),</span><br><span class="line">                            <span class="comment">%% 更新日志</span></span><br><span class="line">                            update_extract_log(OrderNum, WxPayNo, ?WX_REDBAT_EXTRACT_STATE_SUCC, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                        <span class="string">&quot;FAIL&quot;</span> -&gt;</span><br><span class="line">                            ErrCode = value_of(<span class="string">&quot;err_code&quot;</span>, Xml),</span><br><span class="line">                            ErrCodeDesc = value_of(<span class="string">&quot;err_code_des&quot;</span>, Xml),</span><br><span class="line">                            <span class="comment">%% 更新日志</span></span><br><span class="line">                            update_extract_log(OrderNum, <span class="string">&quot;&quot;</span>, ErrCode, ErrCodeDesc)</span><br><span class="line">                    <span class="keyword">end</span>;</span><br><span class="line">                <span class="string">&quot;FAIL&quot;</span> -&gt;</span><br><span class="line">                    Msg = value_of(<span class="string">&quot;return_msg&quot;</span>, Xml),</span><br><span class="line">                    update_extract_log(OrderNum, <span class="string">&quot;&quot;</span>, <span class="string">&quot;FAIL&quot;</span>, Msg),</span><br><span class="line">                    ?ERROR_MSG(<span class="string">&quot;return_msg: ~ts&quot;</span>, [utf8_list_to_string(Msg)])</span><br><span class="line">            <span class="keyword">end</span>;</span><br><span class="line">        Ret -&gt;</span><br><span class="line">            ?ERROR_MSG(<span class="string">&quot;ret:~p&quot;</span>, [Ret])</span><br><span class="line">    <span class="keyword">end</span>.</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">request_post</span><span class="params">(Url, Path, &#123;data, Str&#125;)</span> -&gt;</span></span><br><span class="line">    ReqUrl = lists:concat([Url, Path]),</span><br><span class="line">    SSLOptions = [</span><br><span class="line">        &#123;keyfile,<span class="string">&quot;apiclient_key.pem&quot;</span>&#125;,</span><br><span class="line">        &#123;certfile,<span class="string">&quot;apiclient_cert.pem&quot;</span>&#125;</span><br><span class="line">    ],</span><br><span class="line">    HTTPOptions = [&#123;ssl, SSLOptions&#125;, &#123;timeout, <span class="number">5000</span>&#125;, &#123;version, <span class="string">&quot;HTTP/1.1&quot;</span>&#125;],</span><br><span class="line">    Request = &#123;ReqUrl, [], <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>, iolist_to_binary(Str)&#125;,</span><br><span class="line">    httpc:request(post, Request, HTTPOptions, []).</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">scan_str</span><span class="params">(Str)</span> -&gt;</span></span><br><span class="line">    &#123;XmlElement, _Rest&#125; = xmerl_scan:string(Str, [&#123;space, normalize&#125;]),</span><br><span class="line">    [XmlElement1] = xmerl_lib:remove_whitespace([XmlElement]),</span><br><span class="line">    XmlElement1.</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">value_of</span><span class="params">(Key, #xmlElement&#123;&#125; = X)</span> -&gt;</span></span><br><span class="line">    <span class="keyword">case</span> xmerl_xs:select(Key, X) <span class="keyword">of</span></span><br><span class="line">        [#xmlElement&#123;&#125; = Find] -&gt;</span><br><span class="line">            de_cdata(xmerl_xs:value_of(Find));</span><br><span class="line">        [] -&gt;</span><br><span class="line">            []</span><br><span class="line">    <span class="keyword">end</span>.</span><br><span class="line"><span class="function"><span class="title">de_cdata</span><span class="params">(<span class="string">&quot;![CDATA[&quot;</span> ++ Data)</span> -&gt;</span></span><br><span class="line">    [_,_|Data1] = lists:reverse(Data),</span><br><span class="line">    unescape_str(lists:reverse(Data1));</span><br><span class="line"><span class="function"><span class="title">de_cdata</span><span class="params">(Data)</span> -&gt;</span></span><br><span class="line">    unescape_str(Data).</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">unescape_str</span><span class="params">(Str)</span> -&gt;</span></span><br><span class="line">    Str1 = unicode:characters_to_binary(Str),</span><br><span class="line">    GtEsc  = re:replace(Str1, <span class="string">&quot;&amp;amp;&quot;</span>, <span class="string">&quot;\\&amp;&quot;</span>, [global]),</span><br><span class="line">    LtEsc  = re:replace(GtEsc,  <span class="string">&quot;&amp;gt;&quot;</span>,  <span class="string">&quot;&gt;&quot;</span>,   [global]),</span><br><span class="line">    AmpEsc = re:replace(LtEsc,  <span class="string">&quot;&amp;lt;&quot;</span>,  <span class="string">&quot;&lt;&quot;</span>,   [global]),</span><br><span class="line">    Text   = re:replace(AmpEsc, <span class="string">&quot;&amp;amp;&quot;</span>, <span class="string">&quot;\\&amp;&quot;</span>, [global]),</span><br><span class="line">    util:to_list(Text).</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">export_xml</span><span class="params">(List)</span> -&gt;</span></span><br><span class="line">    Fields = lists:map(</span><br><span class="line">               <span class="keyword">fun</span>(&#123;Key, Value&#125;) -&gt;</span><br><span class="line">                       &#123;Key, [], [util:to_list(Value)]&#125;</span><br><span class="line">               <span class="keyword">end</span>, List),</span><br><span class="line">    Xml = xmerl:export_simple([&#123;xml, Fields&#125;], xmerl_xml, [&#123;prolog, <span class="string">&quot;&quot;</span>&#125;]),</span><br><span class="line">    Xml.</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">utf8_list_to_string</span><span class="params">(List)</span> -&gt;</span></span><br><span class="line">    unicode:characters_to_list(list_to_binary(List)).</span><br></pre></td></tr></table></figure><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ol><li><a href="https://pay.weixin.qq.com/wiki/doc/api/tools/mch_pay.php?chapter=14_2">https://pay.weixin.qq.com/wiki/doc/api/tools/mch_pay.php?chapter=14_2</a></li></ol>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;解决“证书出错，请登录微信支付商户平台下载证书”的核心代码&quot;&gt;&lt;a href=&quot;#解决“证书出错，请登录微信支付商户平台下载证书”的核心代码&quot; class=&quot;headerlink&quot; title=&quot;解决“证书出错，请登录微信支付商户平台下载证书”的核心代码&quot;&gt;&lt;/a&gt;解决“证书出错，请登录微信支付商户平台下载证书”的核心代码&lt;/h3&gt;&lt;figure class=&quot;highlight erlang&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;request_post&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Url, Path, &amp;#123;data, Str&amp;#125;)&lt;/span&gt; -&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ReqUrl = lists:concat([Url, Path]),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;%% +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;%% 😊这个是核心的核心😊&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    SSLOptions = [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123;keyfile,&lt;span class=&quot;string&quot;&gt;&amp;quot;apiclient_key.pem&amp;quot;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123;certfile,&lt;span class=&quot;string&quot;&gt;&amp;quot;apiclient_cert.pem&amp;quot;&lt;/span&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    HTTPOptions = [&amp;#123;ssl, SSLOptions&amp;#125;, &amp;#123;timeout, &lt;span class=&quot;number&quot;&gt;5000&lt;/span&gt;&amp;#125;, &amp;#123;version, &lt;span class=&quot;string&quot;&gt;&amp;quot;HTTP/1.1&amp;quot;&lt;/span&gt;&amp;#125;],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;%% +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Request = &amp;#123;ReqUrl, [], &lt;span class=&quot;string&quot;&gt;&amp;quot;application/x-www-form-urlencoded&amp;quot;&lt;/span&gt;, iolist_to_binary(Str)&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    httpc:request(post, Request, HTTPOptions, []).&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="erlang" scheme="https://www.mingilin.com/categories/erlang/"/>
    
    
    <category term="erlang" scheme="https://www.mingilin.com/tags/erlang/"/>
    
  </entry>
  
  <entry>
    <title>Centos7/8超简单安装nginx-quic</title>
    <link href="https://www.mingilin.com/2020/11/06/centos/centos-nginx-quic/"/>
    <id>https://www.mingilin.com/2020/11/06/centos/centos-nginx-quic/</id>
    <published>2020-11-06T04:00:25.000Z</published>
    <updated>2021-07-06T08:26:23.556Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://hg.nginx.org/nginx-quic/shortlog/quic">nginx-quic</a>是nginx正在开发中的支持http3的版本<br>目前网上大部分的文章都是基于源码编译安装的<br><strong>但对于我这种只有一台垃圾服务器的玩家，源码编译不太现实</strong><br>找了好久，终于找到一个可以直接yum安装的版本：<span id="more"></span><br><a href="https://copr.fedorainfracloud.org/coprs/ryoh/nginx-quic/">https://copr.fedorainfracloud.org/coprs/ryoh/nginx-quic/</a><br>其他发行版可能还是要源码编译。。。</p><p>安装后感觉是访问变快了，也可能是心理作用吧</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>For CentOS 7</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install epel-release</span><br><span class="line">sudo yum install centos-release-scl</span><br><span class="line">sudo yum install yum-plugin-copr</span><br><span class="line">sudo yum copr enable ryoh/nginx-quic</span><br><span class="line">sudo yum install nginx-quic</span><br></pre></td></tr></table></figure><p>For CentOS 8</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo dnf install epel-release</span><br><span class="line">sudo dnf copr enable ryoh/nginx-quic</span><br><span class="line">sudo dnf install nginx-quic</span><br></pre></td></tr></table></figure><blockquote><p>备注：nginx 与 nginx-quic 不能共存，注意备份数据</p></blockquote><p>配置：<br>在<code>server&#123;&#125;</code>中添加</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">listen 443 http3 reuseport;  # UDP listener for QUIC+HTTP/3</span><br><span class="line">ssl_protocols TLSv1.3; # QUIC requires TLS 1.3</span><br><span class="line">add_header Alt-Svc &#x27;$http3=&quot;:443&quot;; ma=86400&#x27;; # Advertise that QUIC is available</span><br><span class="line">add_header QUIC-Status $quic;</span><br></pre></td></tr></table></figure><h2 id="检测是否成功"><a href="#检测是否成功" class="headerlink" title="检测是否成功"></a>检测是否成功</h2><ol><li><p><a href="https://http3check.net/">https://http3check.net/</a></p></li><li><p>Firefox启动<br><code>about:config</code><br><code>network.http.http3.enabled</code>设置为<code>true</code><br><img src="/downloads/assets/http3.png" alt="效果图如下"></p></li></ol><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>1 首次启动失败</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx: [emerg] cannot load certificate &quot;/etc/pki/tls/certs/localhost.crt&quot;: BIO_new_file() ...</span><br></pre></td></tr></table></figure><p>是因为在<code>/etc/nginx/vhost.d/http/00-default.conf</code>有配置本地签名<br>可以将其改名 <code>00-default.conf_bak</code> 或者在本地生成一个证书</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/pki/tls/private/localhost.key -out /etc/ssl/certs/localhost.crt</span><br></pre></td></tr></table></figure><h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><ol><li><a href="https://copr.fedorainfracloud.org/coprs/ryoh/nginx-quic/">https://copr.fedorainfracloud.org/coprs/ryoh/nginx-quic/</a></li><li><a href="https://serverfault.com/questions/648534/accidently-removed-localhost-crt-ssl-in-centos-6-what-can-i-do">https://serverfault.com/questions/648534/accidently-removed-localhost-crt-ssl-in-centos-6-what-can-i-do</a></li><li><a href="https://zhuanlan.zhihu.com/p/159100819">https://zhuanlan.zhihu.com/p/159100819</a></li></ol>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://hg.nginx.org/nginx-quic/shortlog/quic&quot;&gt;nginx-quic&lt;/a&gt;是nginx正在开发中的支持http3的版本&lt;br&gt;目前网上大部分的文章都是基于源码编译安装的&lt;br&gt;&lt;strong&gt;但对于我这种只有一台垃圾服务器的玩家，源码编译不太现实&lt;/strong&gt;&lt;br&gt;找了好久，终于找到一个可以直接yum安装的版本：</summary>
    
    
    
    <category term="centos" scheme="https://www.mingilin.com/categories/centos/"/>
    
    
    <category term="centos" scheme="https://www.mingilin.com/tags/centos/"/>
    
  </entry>
  
  <entry>
    <title>windows下使用命令行将OpenSSH Key转换为ppk</title>
    <link href="https://www.mingilin.com/2020/10/14/windows/windows-puttygen-command/"/>
    <id>https://www.mingilin.com/2020/10/14/windows/windows-puttygen-command/</id>
    <published>2020-10-14T08:33:44.000Z</published>
    <updated>2021-07-06T08:26:23.625Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>LINUX下可以通过安装<code>putty-tools</code>,使用<code>puttygen</code>转换</p></blockquote><p><strong>Windows下，<code>PUTTYGEN</code>是不支持使用命令行的</strong>，可以使用<code>WinSCP</code>实现命令行下转换：<br><code>WinSCP.com /keygen private_key /output=vagrant.ppk /comment=vagrant</code></p><hr><p>配合<code>pageant.exe</code>，可以实现在vagrant中快速添加key，再使用**<a href="/2019/12/26/windows/windows-kitty-winscp-mtputty/">MTPUTTY</a>**登录虚拟机</p><figure class="highlight bat"><figcaption><span>add_key.bat</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">set</span> &quot;WINSCP_DIR=C:\Program Files (x86)\WinSCP&quot;</span><br><span class="line">&quot;<span class="variable">%WINSCP_DIR%</span>\WinSCP.com&quot; /keygen .vagrant\machines\default\virtualbox\private_key /output=vagrant.ppk /comment=vagrant</span><br><span class="line">pageant.exe vagrant.ppk</span><br><span class="line"><span class="built_in">del</span> vagrant.ppk</span><br></pre></td></tr></table></figure><blockquote><p>备注：使用<code>vagrant ssh-config</code>可以查看具体private key文件位置、ssh端口等信息</p></blockquote><figure class="highlight ruby"><figcaption><span>Vagrantfile</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Vagrant.configure(<span class="string">&quot;2&quot;</span>) <span class="keyword">do</span> <span class="params">|config|</span></span><br><span class="line">    ...</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">system(<span class="string">&#x27;./add_key.bat&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="windows" scheme="https://www.mingilin.com/categories/windows/"/>
    
    
    <category term="windows" scheme="https://www.mingilin.com/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>解决Google搜索跳转到yahoo</title>
    <link href="https://www.mingilin.com/2020/09/17/other/other-google-search-redirect-yahoo/"/>
    <id>https://www.mingilin.com/2020/09/17/other/other-google-search-redirect-yahoo/</id>
    <published>2020-09-17T03:35:17.000Z</published>
    <updated>2021-07-06T08:26:23.601Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>个人使用<code>Edge Beta浏览器</code><br>今天使用Google搜索的时候，会跳转到yahoo搜索，很是烦人<br>中间有个跳转链接是<code>www.coolnewtabtheme.com/...</code></p><p><del>一开始有文章说在搜索引擎管理将yahoo的删掉，发现<strong>没用</strong></del></p><blockquote><p><strong>正确的解决方案：</strong><br><strong>禁用所有的扩展，然后一个一个开启，然后验证Google搜索是否正常</strong></p></blockquote><p>个人最后排查出有问题的插件：<code>TabSplit</code>，到<code>Google Web Store</code>看了下，已经没有这个插件了<br>是否用<code>Chrome浏览器</code>就不会有这种安全问题了？？？</p><h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><ol><li><a href="https://forum.vivaldi.net/topic/48969/google-search-switches-automatically-to-yahoo/6">https://forum.vivaldi.net/topic/48969/google-search-switches-automatically-to-yahoo/6</a></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="other" scheme="https://www.mingilin.com/categories/other/"/>
    
    
    <category term="other" scheme="https://www.mingilin.com/tags/other/"/>
    
  </entry>
  
  <entry>
    <title>Zeal添加文档的历史版本</title>
    <link href="https://www.mingilin.com/2020/08/18/other/other-zeal/"/>
    <id>https://www.mingilin.com/2020/08/18/other/other-zeal/</id>
    <published>2020-08-18T08:13:18.000Z</published>
    <updated>2021-07-06T08:26:23.608Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://zealdocs.org/">Zeal</a>是支持超多语言的离线文档查看器<br>默认只会下载最新版本，项目中使用旧版本的文档，需要旧版本的文档，记录下添加方式</p><span id="more"></span><p>以<code>Erlang21.2</code>为例记录下，安装旧版本的文档</p><h2 id="找到下载链接"><a href="#找到下载链接" class="headerlink" title="找到下载链接"></a>找到下载链接</h2><p>先从 <a href="https://github.com/Kapeli/feeds">https://github.com/Kapeli/feeds</a> 查看<code>Erlang.xml</code>，内容如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>23.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ios_version</span>&gt;</span>1<span class="tag">&lt;/<span class="name">ios_version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://sanfrancisco.kapeli.com/feeds/Erlang.tgz<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://london.kapeli.com/feeds/Erlang.tgz<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://newyork.kapeli.com/feeds/Erlang.tgz<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://tokyo.kapeli.com/feeds/Erlang.tgz<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://frankfurt.kapeli.com/feeds/Erlang.tgz<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://singapore.kapeli.com/feeds/Erlang.tgz<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">other-versions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>23.0<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>22.3<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>22.2<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>22.1<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>22.0<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>21.3<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>21.2<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>21.1<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">other-versions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br></pre></td></tr></table></figure><p>通过 <a href="https://jlice.top/p/879df/">https://jlice.top/p/879df/</a> 文章获得历史版本链接模板：<br><a href="http://sanfrancisco.kapeli.com/feeds/zzz/versions/%7BDocsetName%7D/%7Bversion%7D/%7BDocsetName%7D.tgz">http://sanfrancisco.kapeli.com/feeds/zzz/versions/{DocsetName}/{version}/{DocsetName}.tgz</a></p><p>替换后的链接：<br><code>http://sanfrancisco.kapeli.com/feeds/zzz/versions/Erlang/21.2/Erlang.tgz</code></p><h2 id="自定义xml"><a href="#自定义xml" class="headerlink" title="自定义xml"></a>自定义xml</h2><p>自定义xml文件名字：<code>Erlang21.2.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>21.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ios_version</span>&gt;</span>1<span class="tag">&lt;/<span class="name">ios_version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://sanfrancisco.kapeli.com/feeds/zzz/versions/Erlang/21.2/Erlang.tgz<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://london.kapeli.com/feeds/zzz/versions/Erlang/21.2/Erlang.tgz<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://newyork.kapeli.com/feeds/zzz/versions/Erlang/21.2/Erlang.tgz<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://tokyo.kapeli.com/feeds/zzz/versions/Erlang/21.2/Erlang.tgz<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://frankfurt.kapeli.com/feeds/zzz/versions/Erlang/21.2/Erlang.tgz<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://singapore.kapeli.com/feeds/zzz/versions/Erlang/21.2/Erlang.tgz<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">other-versions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">other-versions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>Add Feed</code>添加链接<code>file:///E:/web/zeal/Erlang21.2.xml</code></p><blockquote><p>E:/web/zeal/Erlang21.2.xml 是 xml的路径</p></blockquote><h2 id="修改搜索名字"><a href="#修改搜索名字" class="headerlink" title="修改搜索名字"></a>修改搜索名字</h2><p>在zeal安装目录下找到<code>docsets/Erlang21.2.docset/Contents/Info.plist</code>文件，将<code>erlang</code>修改为<code>erlang21</code><br>重启后就可以使用<code>erlang21: lists:seq</code>查询文档了</p><h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><ol><li><a href="https://jlice.top/p/879df/">https://jlice.top/p/879df/</a></li></ol>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://zealdocs.org/&quot;&gt;Zeal&lt;/a&gt;是支持超多语言的离线文档查看器&lt;br&gt;默认只会下载最新版本，项目中使用旧版本的文档，需要旧版本的文档，记录下添加方式&lt;/p&gt;</summary>
    
    
    
    <category term="other" scheme="https://www.mingilin.com/categories/other/"/>
    
    
    <category term="other" scheme="https://www.mingilin.com/tags/other/"/>
    
  </entry>
  
  <entry>
    <title>powershell实现的股票查看小工具</title>
    <link href="https://www.mingilin.com/2020/06/05/windows/window-powershell-stock/"/>
    <id>https://www.mingilin.com/2020/06/05/windows/window-powershell-stock/</id>
    <published>2020-06-05T01:08:52.000Z</published>
    <updated>2021-07-06T08:26:23.618Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/downloads/code/stock/stock.gif" alt="效果展示"></p><span id="more"></span><p>包括配置文件(<a href="/downloads/code/stock/stock.json">stock.json</a>)和代码(<a href="/downloads/code/stock/stock.ps1">stock.ps1</a>)</p><blockquote><p><font color=darkred>备注: 下载后将两个文件的编码修改为GBK(CP936)</font></p></blockquote><p>下面是完整的代码:</p><figure class="highlight json"><figcaption><span>配置文件</span><a href="/downloads/code/stock/stock.json">view raw</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="attr">&quot;comment_stock_list&quot;</span>: <span class="string">&quot;股票代码,若不是很清楚,使用http://hq.sinajs.cn/list=sh000001看下是否有返回&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;stock_list&quot;</span>: [</span><br><span class="line">        {<span class="attr">&quot;stock_id&quot;</span>: <span class="string">&quot;sz002548&quot;</span>, <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;金新农&quot;</span>},</span><br><span class="line">        {<span class="attr">&quot;stock_id&quot;</span>: <span class="string">&quot;sh603005&quot;</span>, <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;晶方科技&quot;</span>},</span><br><span class="line">        {<span class="attr">&quot;stock_id&quot;</span>: <span class="string">&quot;sz000725&quot;</span>, <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;京东方A&quot;</span>},</span><br><span class="line">        {<span class="attr">&quot;stock_id&quot;</span>: <span class="string">&quot;sh601012&quot;</span>, <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;隆基股份&quot;</span>},</span><br><span class="line">        {<span class="attr">&quot;stock_id&quot;</span>: <span class="string">&quot;sz300722&quot;</span>, <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;新余国科&quot;</span>},</span><br><span class="line">        {<span class="attr">&quot;stock_id&quot;</span>: <span class="string">&quot;sz300564&quot;</span>, <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;筑博设计&quot;</span>},</span><br><span class="line">        {<span class="attr">&quot;stock_id&quot;</span>: <span class="string">&quot;sz000708&quot;</span>, <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;中信特钢&quot;</span>},</span><br><span class="line">        {<span class="attr">&quot;stock_id&quot;</span>: <span class="string">&quot;sz002625&quot;</span>, <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;光启技术&quot;</span>},</span><br><span class="line">        {<span class="attr">&quot;stock_id&quot;</span>: <span class="string">&quot;sz002230&quot;</span>, <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;科大讯飞&quot;</span>},</span><br><span class="line">        {<span class="attr">&quot;stock_id&quot;</span>: <span class="string">&quot;sz002156&quot;</span>, <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;通富微电&quot;</span>}</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;comment_refresh_time&quot;</span>: <span class="string">&quot;刷新时间&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;refresh_time&quot;</span>: <span class="number">10</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><figcaption><span>代码</span><a href="/downloads/code/stock/stock.ps1">view raw</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 使用powershell查看股票</span></span><br><span class="line"><span class="comment">## kingwen0302@msn.com</span></span><br><span class="line"><span class="comment">## www.mingilin.com</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$cfgPath</span> = <span class="built_in">Join-Path</span> <span class="variable">$PSScriptRoot</span> <span class="string">&quot;stock.json&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadStockCode</span><span class="params">()</span></span> {</span><br><span class="line">    <span class="variable">$json</span> = <span class="built_in">Get-Content</span> <span class="variable">$cfgPath</span> | <span class="built_in">ConvertFrom-Json</span></span><br><span class="line">    <span class="variable">$json</span></span><br><span class="line">}</span><br><span class="line"><span class="comment">## -1: 股票代码;</span></span><br><span class="line"><span class="comment">## 0:&quot;大秦铁路&quot;,股票名字;</span></span><br><span class="line"><span class="comment">## 1:&quot;27.55&quot;,今日开盘价;</span></span><br><span class="line"><span class="comment">## 2:&quot;27.25&quot;,昨日收盘价;</span></span><br><span class="line"><span class="comment">## 3:&quot;26.91&quot;,当前价格;</span></span><br><span class="line"><span class="comment">## 4:&quot;27.55&quot;,今日最高价;</span></span><br><span class="line"><span class="comment">## 5:&quot;26.20&quot;,今日最低价;</span></span><br><span class="line"><span class="comment">## 6:&quot;26.91&quot;,竞买价,即“买一&quot;报价;</span></span><br><span class="line"><span class="comment">## 7:&quot;26.92&quot;,竞卖价,即“卖一&quot;报价;</span></span><br><span class="line"><span class="comment">## 8:&quot;22114263&quot;,成交的股票数,由于股票交易以一百股为基本单位,所以在使用时,通常把该值除以一百;</span></span><br><span class="line"><span class="comment">## 9:&quot;589824680&quot;,成交金额,单位为“元&quot;,为了一目了然,通常以“万元&quot;为成交金额的单位,所以通常把该值除以一万;</span></span><br><span class="line"><span class="comment">## 10:&quot;4695&quot;,“买一&quot;申请4695股,即47手;</span></span><br><span class="line"><span class="comment">## 11:&quot;26.91&quot;,“买一&quot;报价;</span></span><br><span class="line"><span class="comment">## 12:&quot;57590&quot;,“买二&quot;</span></span><br><span class="line"><span class="comment">## 13:&quot;26.90&quot;,“买二&quot;</span></span><br><span class="line"><span class="comment">## 14:&quot;14700&quot;,“买三&quot;</span></span><br><span class="line"><span class="comment">## 15:&quot;26.89&quot;,“买三&quot;</span></span><br><span class="line"><span class="comment">## 16:&quot;14300&quot;,“买四&quot;</span></span><br><span class="line"><span class="comment">## 17:&quot;26.88&quot;,“买四&quot;</span></span><br><span class="line"><span class="comment">## 18:&quot;15100&quot;,“买五&quot;</span></span><br><span class="line"><span class="comment">## 19:&quot;26.87&quot;,“买五&quot;</span></span><br><span class="line"><span class="comment">## 20:&quot;3100&quot;,“卖一&quot;申报3100股,即31手;</span></span><br><span class="line"><span class="comment">## 21:&quot;26.92&quot;,“卖一&quot;报价</span></span><br><span class="line"><span class="comment">## (22, 23), (24, 25), (26,27), (28, 29)分别为“卖二&quot;至“卖四的情况&quot;</span></span><br><span class="line"><span class="comment">## 30:&quot;2008-01-11&quot;,日期;</span></span><br><span class="line"><span class="comment">## 31:&quot;15:05:32&quot;,时间;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ShowOne</span><span class="params">([string]<span class="variable">$content</span>)</span></span>{</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$content</span> <span class="operator">-match</span> <span class="string">&quot;^\n<span class="variable">$</span>&quot;</span>) {</span><br><span class="line">    } <span class="keyword">else</span>{</span><br><span class="line">        <span class="variable">$str_splits</span> = <span class="variable">$content</span>.Split(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">        <span class="variable">$stockName</span> = <span class="variable">$str_splits</span>[<span class="number">0</span>].split(<span class="string">&#x27;&quot;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="variable">$myStockId</span> = <span class="variable">$stockName</span>[<span class="number">0</span>].Split(<span class="string">&#x27;=&#x27;</span>)[<span class="number">0</span>].Split(<span class="string">&#x27;_&#x27;</span>)[<span class="number">2</span>]</span><br><span class="line">        <span class="variable">$myStock</span> = <span class="variable">$stockName</span>[<span class="number">1</span>]</span><br><span class="line">        <span class="variable">$lastPrice</span> = <span class="variable">$str_splits</span>[<span class="number">2</span>]</span><br><span class="line">        <span class="variable">$nowPrice</span> = <span class="variable">$str_splits</span>[<span class="number">3</span>]</span><br><span class="line">        <span class="variable">$higePrice</span> = <span class="variable">$str_splits</span>[<span class="number">4</span>]</span><br><span class="line">        <span class="variable">$lowPrice</span>= <span class="variable">$str_splits</span>[<span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">        <span class="variable">$exchange</span> = (<span class="variable">$str_splits</span>[<span class="number">9</span>] / <span class="number">10000</span>) <span class="operator">-as</span> [<span class="built_in">int</span>]</span><br><span class="line"></span><br><span class="line">        <span class="variable">$buy1Count</span> = (<span class="variable">$str_splits</span>[<span class="number">10</span>] / <span class="number">100</span>) <span class="operator">-as</span> [<span class="built_in">int</span>]</span><br><span class="line">        <span class="variable">$buy1Price</span> = <span class="variable">$str_splits</span>[<span class="number">11</span>]</span><br><span class="line">        <span class="variable">$sale1Count</span> = (<span class="variable">$str_splits</span>[<span class="number">20</span>] / <span class="number">100</span>) <span class="operator">-as</span> [<span class="built_in">int</span>]</span><br><span class="line">        <span class="variable">$sale1Price</span> = <span class="variable">$str_splits</span>[<span class="number">21</span>]</span><br><span class="line"></span><br><span class="line"><span class="variable">$diffPrice</span> = <span class="variable">$nowPrice</span> - <span class="variable">$lastPrice</span></span><br><span class="line">        <span class="variable">$priceP</span> = <span class="variable">$diffPrice</span> / <span class="variable">$lastPrice</span></span><br><span class="line"><span class="comment">#        [double] $a=&quot;{0:0.####}&quot; -f $priceP</span></span><br><span class="line"><span class="comment">#        $b=&quot;{0:p2}&quot; -f $a</span></span><br><span class="line"></span><br><span class="line">        <span class="variable">$b</span> = <span class="string">&quot;{0:p2}&quot;</span> <span class="operator">-f</span> <span class="variable">$priceP</span></span><br><span class="line">        <span class="variable">$dp</span>=<span class="string">&quot;{0:0.####}&quot;</span> <span class="operator">-f</span> <span class="variable">$diffPrice</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>([<span class="type">convert</span>]::ToDouble(<span class="variable">$lastPrice</span>) <span class="operator">-gt</span> [<span class="type">convert</span>]::ToDouble(<span class="variable">$nowPrice</span>) ) {</span><br><span class="line">            <span class="variable">$myColor</span>=<span class="string">&quot;Green&quot;</span></span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="variable">$myColor</span>=<span class="string">&quot;Red&quot;</span></span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>([<span class="type">convert</span>]::ToDouble(<span class="variable">$sale1Count</span>) <span class="operator">-gt</span> [<span class="type">convert</span>]::ToDouble(<span class="variable">$buy1Count</span>)) {</span><br><span class="line">            <span class="variable">$saleColor</span> = <span class="string">&quot;DarkGreen&quot;</span></span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="variable">$saleColor</span> = <span class="string">&quot;DarkRed&quot;</span></span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="literal">-NoNewline</span> <span class="literal">-ForegroundColor</span> <span class="variable">$myColor</span> (<span class="string">&quot;<span class="variable">$myStockId</span>&quot;</span>.PadRight(<span class="number">10</span>))</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="literal">-NoNewline</span> <span class="literal">-ForegroundColor</span> <span class="variable">$myColor</span> <span class="string">&quot;<span class="variable">$myStock</span>`t&quot;</span></span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="literal">-NoNewline</span> <span class="literal">-ForegroundColor</span> <span class="variable">$myColor</span> <span class="string">&quot;N<span class="variable">$nowPrice</span>&quot;</span>.PadRight(<span class="number">10</span>) <span class="string">&quot;(&quot;</span> <span class="string">&quot;<span class="variable">$dp</span>&quot;</span>.PadLeft(<span class="number">8</span>) <span class="string">&quot;<span class="variable">$b</span>&quot;</span>.PadLeft(<span class="number">8</span>) <span class="string">&quot;) &quot;</span></span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="literal">-NoNewline</span> <span class="literal">-ForegroundColor</span> <span class="variable">$myColor</span> <span class="string">&quot;H<span class="variable">$higePrice</span>&quot;</span>.PadRight(<span class="number">10</span>)</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="literal">-NoNewline</span> <span class="literal">-ForegroundColor</span> <span class="variable">$myColor</span> <span class="string">&quot;L<span class="variable">$lowPrice</span>&quot;</span>.PadRight(<span class="number">10</span>)</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="literal">-NoNewline</span> <span class="literal">-BackgroundColor</span> <span class="variable">$saleColor</span> <span class="literal">-ForegroundColor</span> <span class="variable">$myColor</span> <span class="string">&quot;S<span class="variable">$sale1Price</span> (<span class="variable">$sale1Count</span>)&quot;</span>.PadRight(<span class="number">20</span>)</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="literal">-NoNewline</span> <span class="literal">-BackgroundColor</span> <span class="variable">$saleColor</span> <span class="literal">-ForegroundColor</span> <span class="variable">$myColor</span> <span class="string">&quot;B<span class="variable">$buy1Price</span> (<span class="variable">$buy1Count</span>)&quot;</span>.PadRight(<span class="number">20</span>)</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="literal">-NoNewline</span> <span class="literal">-ForegroundColor</span> <span class="variable">$myColor</span> (<span class="string">&quot;E<span class="variable">$exchange</span>&quot;</span>).PadRight(<span class="number">6</span>)</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ShowOne2</span><span class="params">([string]<span class="variable">$content</span>)</span></span>{</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$content</span> <span class="operator">-match</span> <span class="string">&quot;^\n<span class="variable">$</span>&quot;</span>)</span><br><span class="line">    {</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    {</span><br><span class="line">        <span class="variable">$str_splits</span> = <span class="variable">$content</span>.Split(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">        <span class="variable">$stockName</span> = <span class="variable">$str_splits</span>[<span class="number">0</span>].split(<span class="string">&#x27;&quot;&#x27;</span>)</span><br><span class="line">        <span class="variable">$myStockId</span> = <span class="variable">$stockName</span>[<span class="number">0</span>].Split(<span class="string">&#x27;=&#x27;</span>)[<span class="number">0</span>].Split(<span class="string">&#x27;_&#x27;</span>)[<span class="number">3</span>]</span><br><span class="line">        <span class="variable">$myStock</span> = <span class="variable">$stockName</span>[<span class="number">1</span>]</span><br><span class="line">        <span class="variable">$nowPrice</span> = <span class="variable">$str_splits</span>[<span class="number">1</span>]</span><br><span class="line">        <span class="variable">$ricePrice</span> = <span class="variable">$str_splits</span>[<span class="number">2</span>]</span><br><span class="line">        <span class="variable">$ricePriceP</span> = <span class="variable">$str_splits</span>[<span class="number">3</span>]</span><br><span class="line">        <span class="variable">$mon</span>=<span class="variable">$str_splits</span>[<span class="number">5</span>].Replace(<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$ricePrice</span> <span class="operator">-match</span> <span class="string">&#x27;^-&#x27;</span>) {</span><br><span class="line">            <span class="variable">$myColor</span>=<span class="string">&quot;Green&quot;</span></span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="variable">$myColor</span>=<span class="string">&quot;Red&quot;</span></span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="literal">-NoNewline</span> <span class="literal">-ForegroundColor</span> <span class="variable">$myColor</span> (<span class="string">&quot;<span class="variable">$myStockId</span>&quot;</span>.PadRight(<span class="number">10</span>))</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="literal">-NoNewline</span> <span class="literal">-ForegroundColor</span> <span class="variable">$myColor</span> <span class="string">&quot;<span class="variable">$myStock</span>`t&quot;</span></span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="literal">-NoNewline</span> <span class="literal">-ForegroundColor</span> <span class="variable">$myColor</span> <span class="string">&quot;N<span class="variable">$nowPrice</span>&quot;</span>.PadRight(<span class="number">10</span>) <span class="string">&quot;(&quot;</span> <span class="string">&quot;<span class="variable">$ricePrice</span>&quot;</span>.PadLeft(<span class="number">8</span>) <span class="string">&quot;<span class="variable">$ricePriceP</span>%&quot;</span>.PadLeft(<span class="number">8</span>) <span class="string">&quot;) &quot;</span></span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="literal">-NoNewline</span> <span class="literal">-ForegroundColor</span> <span class="variable">$myColor</span> (<span class="string">&quot;M<span class="variable">$mon</span>&quot;</span>.PadRight(<span class="number">20</span>))</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ShowOne4</span><span class="params">([string]<span class="variable">$content</span>)</span></span>{</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$content</span> <span class="operator">-match</span> <span class="string">&quot;^\n<span class="variable">$</span>&quot;</span>)</span><br><span class="line">    {</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    {</span><br><span class="line">        <span class="variable">$str_splits</span> = <span class="variable">$content</span>.Split(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">        <span class="variable">$stockName</span> = <span class="variable">$str_splits</span>[<span class="number">0</span>].split(<span class="string">&#x27;&quot;&#x27;</span>)</span><br><span class="line">        <span class="variable">$myStockId</span> = <span class="variable">$stockName</span>[<span class="number">0</span>].Split(<span class="string">&#x27;=&#x27;</span>)[<span class="number">0</span>].Split(<span class="string">&#x27;_&#x27;</span>)[<span class="number">3</span>]</span><br><span class="line">        <span class="variable">$myStock</span> = <span class="variable">$stockName</span>[<span class="number">1</span>]</span><br><span class="line">        <span class="variable">$nowPrice</span> = <span class="variable">$str_splits</span>[<span class="number">1</span>]</span><br><span class="line">        <span class="variable">$ricePrice</span> = <span class="variable">$str_splits</span>[<span class="number">2</span>]</span><br><span class="line">        <span class="variable">$ricePriceP</span> = <span class="variable">$str_splits</span>[<span class="number">3</span>].Replace(<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$ricePrice</span> <span class="operator">-match</span> <span class="string">&#x27;^-&#x27;</span>) {</span><br><span class="line">            <span class="variable">$myColor</span>=<span class="string">&quot;Green&quot;</span></span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="variable">$myColor</span>=<span class="string">&quot;Red&quot;</span></span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="literal">-NoNewline</span> <span class="literal">-ForegroundColor</span> <span class="variable">$myColor</span> (<span class="string">&quot;<span class="variable">$myStockId</span>&quot;</span>.PadRight(<span class="number">10</span>))</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="literal">-NoNewline</span> <span class="literal">-ForegroundColor</span> <span class="variable">$myColor</span> <span class="string">&quot;<span class="variable">$myStock</span>`t&quot;</span></span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="literal">-NoNewline</span> <span class="literal">-ForegroundColor</span> <span class="variable">$myColor</span> <span class="string">&quot;N<span class="variable">$nowPrice</span>&quot;</span>.PadRight(<span class="number">10</span>) <span class="string">&quot;(&quot;</span> <span class="string">&quot;<span class="variable">$ricePrice</span>&quot;</span>.PadLeft(<span class="number">8</span>) <span class="string">&quot;<span class="variable">$ricePriceP</span>%&quot;</span>.PadLeft(<span class="number">8</span>) <span class="string">&quot;) &quot;</span></span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ShowOne3</span><span class="params">(<span class="variable">$stockCode</span>)</span></span> {</span><br><span class="line"></span><br><span class="line">    <span class="variable">$date</span> = <span class="built_in">Get-Date</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="literal">-BackgroundColor</span> Blue <span class="string">&quot;配置文件: <span class="variable">$cfgPath</span>&quot;</span></span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="literal">-BackgroundColor</span> DarkRed <span class="string">&quot;刷新时间: <span class="variable">$date</span>&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;=&quot;</span>*<span class="number">130</span></span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="literal">-ForegroundColor</span> Yellow <span class="string">&quot;N-当前价格; H-今日最高价格; L-今日最低价格 B-买1价格,买1数量 S-卖1价格,卖1数量 E-交易金额(万元)&quot;</span></span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="literal">-BackgroundColor</span> DarkRed <span class="string">&quot;`t`t`t`t`t`t`t`tPOWERED BY kingwen0302@msn.com(https://www.mingilin.com)&quot;</span></span><br><span class="line">    <span class="string">&quot;-&quot;</span>*<span class="number">130</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">## 显示指数</span></span><br><span class="line">    <span class="variable">$sourceURL</span> = <span class="string">&quot;http://hq.sinajs.cn/list=s_sh000001,s_sz399001&quot;</span></span><br><span class="line">    <span class="variable">$wc</span> = <span class="built_in">New-Object</span> system.net.webclient</span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$wc</span>.downloadstring(<span class="variable">$sourceURL</span>)</span><br><span class="line">    <span class="variable">$content</span>.Split(<span class="string">&#x27;;&#x27;</span>) | <span class="built_in">ForEach-Object</span> {ShowOne2 <span class="variable">$_</span> }</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 显示国外指数</span></span><br><span class="line">    <span class="comment">## $sourceURL = &quot;http://hq.sinajs.cn/list=int_dji,int_nasdaq,int_hangseng,int_nikkei,b_TWSE,b_FSSTI&quot;</span></span><br><span class="line">    <span class="comment">## $wc = New-Object system.net.webclient</span></span><br><span class="line">    <span class="comment">## $content = $wc.downloadstring($sourceURL)</span></span><br><span class="line">    <span class="comment">## $content.Split(&#x27;;&#x27;) | ForEach-Object {ShowOne4 $_ }</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;-&quot;</span>*<span class="number">130</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">## 显示个股</span></span><br><span class="line">    <span class="variable">$sourceURL</span> = <span class="string">&quot;http://hq.sinajs.cn/list=<span class="variable">$stockCode</span>&quot;</span></span><br><span class="line">    <span class="variable">$wc</span> = <span class="built_in">New-Object</span> system.net.webclient</span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$wc</span>.downloadstring(<span class="variable">$sourceURL</span>)</span><br><span class="line">    <span class="variable">$content</span>.Split(<span class="string">&#x27;;&#x27;</span>) | <span class="built_in">ForEach-Object</span> {ShowOne <span class="variable">$_</span> }</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;=&quot;</span>*<span class="number">130</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>) {</span><br><span class="line">    <span class="built_in">Clear-Host</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$json</span> = loadStockCode</span><br><span class="line"></span><br><span class="line">    <span class="variable">$stockCode</span> = <span class="variable">$json</span>.stock_list | <span class="built_in">ForEach-Object</span> {<span class="variable">$_</span>.stock_id}</span><br><span class="line">    <span class="variable">$stockCode</span> = <span class="variable">$stockCode</span> <span class="operator">-Join</span> <span class="string">&quot;,&quot;</span></span><br><span class="line">    ShowOne3 <span class="variable">$stockCode</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$refreshTime</span> = <span class="variable">$json</span>.refresh_time</span><br><span class="line">    <span class="built_in">Start-Sleep</span> <span class="variable">$refreshTime</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/downloads/code/stock/stock.gif&quot; alt=&quot;效果展示&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="windows" scheme="https://www.mingilin.com/categories/windows/"/>
    
    
    <category term="windows" scheme="https://www.mingilin.com/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>几种开源网盘整理</title>
    <link href="https://www.mingilin.com/2020/03/13/centos/centos-filemanager-list/"/>
    <id>https://www.mingilin.com/2020/03/13/centos/centos-filemanager-list/</id>
    <published>2020-03-13T07:14:57.000Z</published>
    <updated>2021-07-06T10:00:45.453Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>记录下自己使用过的开源网盘: <code>KODExplorer</code>,<code>NextCloud</code></p></blockquote><span id="more"></span><h2 id="KODExplorer"><a href="#KODExplorer" class="headerlink" title="KODExplorer"></a>KODExplorer</h2><p>芒果云是一个开源网盘,支持在线编辑和预览文件, 付费版功能更多, 该网盘不需要数据库支持<br><a href="http://kodcloud.com/index.html">http://kodcloud.com/index.html</a></p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">yum install -y http://rpms.remirepo.net/enterprise/remi-release-7.rpm</span><br><span class="line">yum install -y php72 php72-php-fpm nginx php72-php-mbstring php72-php-gd httpd-tools</span><br><span class="line">systemctl enable nginx</span><br><span class="line">systemctl enable php72-php-fpm</span><br><span class="line">systemctl start nginx</span><br><span class="line">systemctl start php72-php-fpm</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 下载源码</span></span></span><br><span class="line">git clone https://github.com/kalcaddle/KODExplorer.git</span><br><span class="line">chmod -Rf 777 ./KODExplorer/*</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 这个一步一定要, 否则会提示权限不足</span></span></span><br><span class="line">chmod 777 ./KODExplorer</span><br></pre></td></tr></table></figure><h3 id="NGINX-配置"><a href="#NGINX-配置" class="headerlink" title="NGINX 配置"></a>NGINX 配置</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 其他配置...</span></span><br><span class="line"></span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">        <span class="attribute">charset</span> utf8;</span><br><span class="line">        <span class="attribute">root</span>   /data/KODExplorer;</span><br><span class="line">        <span class="attribute">index</span> index.php;</span><br><span class="line">        <span class="attribute">autoindex</span> <span class="literal">on</span>;</span><br><span class="line">        <span class="attribute">autoindex_exact_size</span> <span class="literal">off</span>;</span><br><span class="line">        <span class="attribute">autoindex_localtime</span> <span class="literal">on</span>;</span><br><span class="line">     &#125;</span><br><span class="line">    <span class="attribute">location</span> <span class="regexp">~ \.php$</span> &#123;</span><br><span class="line">         <span class="attribute">root</span>           /data/KODExplorer;</span><br><span class="line">         <span class="attribute">fastcgi_pass</span>   <span class="number">127.0.0.1:9000</span>;</span><br><span class="line">         <span class="attribute">fastcgi_index</span>  index.php;</span><br><span class="line">         <span class="attribute">fastcgi_param</span>  SCRIPT_FILENAME  $document_root$fastcgi_script_name;</span><br><span class="line">         <span class="attribute">fastcgi_connect_timeout</span> <span class="number">75</span>;</span><br><span class="line">         <span class="attribute">fastcgi_read_timeout</span> <span class="number">1200</span>;</span><br><span class="line">         <span class="attribute">fastcgi_send_timeout</span> <span class="number">1200</span>;</span><br><span class="line">         <span class="attribute">include</span>        fastcgi_params;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">## 其他配置...</span></span><br><span class="line"></span><br><span class="line">    <span class="attribute">location</span> /filemanager/ &#123;</span><br><span class="line">        <span class="attribute">root</span> /data/web;</span><br><span class="line">        <span class="attribute">index</span> index.php;</span><br><span class="line">        <span class="attribute">location</span> ~\.php$ &#123;</span><br><span class="line">            <span class="attribute">fastcgi_pass</span>   <span class="number">127.0.0.1:9000</span>;</span><br><span class="line">            <span class="attribute">fastcgi_index</span>  index.php;</span><br><span class="line">            <span class="attribute">fastcgi_param</span>  SCRIPT_FILENAME  $document_root$fastcgi_script_name;</span><br><span class="line">            <span class="attribute">fastcgi_connect_timeout</span> <span class="number">75</span>; </span><br><span class="line">            <span class="attribute">fastcgi_read_timeout</span> <span class="number">1200</span>;</span><br><span class="line">            <span class="attribute">fastcgi_send_timeout</span> <span class="number">1200</span>;</span><br><span class="line">            <span class="attribute">include</span>        fastcgi_params;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>不要折腾alias了,太麻烦了,直接root就可以了<br>root要求源码目录地址是/data/web/filemanager/</p></blockquote><h2 id="NextCloud"><a href="#NextCloud" class="headerlink" title="NextCloud"></a>NextCloud</h2><p><a href="https://nextcloud.com/">NextCloud</a>是国外的一款开源网盘，相较于<a href="http://kodcloud.com/">芒果云</a>，个人感觉是客户端比较完善。但是，要求服务器偏高，无奈放弃。</p><!-- more --><h3 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h3><ul><li><code>PHP5.6</code>（<a href="https://www.mingilin.com/2017/09/29/centos/centos-php56/">安装方式</a>）<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">rpm -qa | grep php</span></span><br><span class="line">php71w-pdo-7.1.10-1.w6.i386</span><br><span class="line">php71w-opcache-7.1.10-1.w6.i386</span><br><span class="line">mod_php71w-7.1.10-1.w6.i386</span><br><span class="line">php71w-mysql-7.1.10-1.w6.i386</span><br><span class="line">php71w-gd-7.1.10-1.w6.i386</span><br><span class="line">php71w-common-7.1.10-1.w6.i386</span><br><span class="line">php71w-fpm-7.1.10-1.w6.i386</span><br><span class="line">php71w-xml-7.1.10-1.w6.i386</span><br><span class="line">php71w-cli-7.1.10-1.w6.i386</span><br><span class="line">php71w-mbstring-7.1.10-1.w6.i386</span><br></pre></td></tr></table></figure></li><li><code>MYSQL</code>（可选）</li></ul><h3 id="NGINX-配置-1"><a href="#NGINX-配置-1" class="headerlink" title="NGINX 配置"></a>NGINX 配置</h3><figure class="highlight nginx"><figcaption><span>nextcloud配置备份</span><a href="/downloads/code/nextcloud.web.mingilin.com.conf_bak">view raw</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">upstream</span> php-handler {</span><br><span class="line">    <span class="attribute">server</span> <span class="number">127.0.0.1:9000</span>;</span><br><span class="line">    <span class="comment">#server unix:/var/run/php5-fpm.sock;</span></span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="section">server</span> {</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> nextcloud.web.mingilin.com;</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Add headers to serve security related headers</span></span><br><span class="line">    <span class="comment"># Before enabling Strict-Transport-Security headers please read into this topic first.</span></span><br><span class="line">    <span class="attribute">add_header</span> Strict-Transport-Security <span class="string">&quot;max-age=15552000; includeSubDomains&quot;</span>;</span><br><span class="line">    <span class="attribute">add_header</span> X-Content-Type-Options nosniff;</span><br><span class="line">    <span class="attribute">add_header</span> X-Frame-Options <span class="string">&quot;SAMEORIGIN&quot;</span>;</span><br><span class="line">    <span class="attribute">add_header</span> X-XSS-Protection <span class="string">&quot;1; mode=block&quot;</span>;</span><br><span class="line">    <span class="attribute">add_header</span> X-Robots-Tag <span class="literal">none</span>;</span><br><span class="line">    <span class="attribute">add_header</span> X-Download-Options noopen;</span><br><span class="line">    <span class="attribute">add_header</span> X-Permitted-Cross-Domain-Policies <span class="literal">none</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Path to the root of your installation</span></span><br><span class="line">    <span class="attribute">root</span> /data/nextcloud/nextcloud;</span><br><span class="line"> </span><br><span class="line">    <span class="attribute">location</span> = /robots.txt {</span><br><span class="line">        <span class="attribute">allow</span> all;</span><br><span class="line">        <span class="attribute">log_not_found</span> <span class="literal">off</span>;</span><br><span class="line">        <span class="attribute">access_log</span> <span class="literal">off</span>;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># The following 2 rules are only needed for the user_webfinger app.</span></span><br><span class="line">    <span class="comment"># Uncomment it if you&#x27;re planning to use this app.</span></span><br><span class="line">    <span class="comment">#rewrite ^/.well-known/host-meta /public.php?service=host-meta last;</span></span><br><span class="line">    <span class="comment">#rewrite ^/.well-known/host-meta.json /public.php?service=host-meta-json last;</span></span><br><span class="line"> </span><br><span class="line">    <span class="attribute">location</span> = /.well-known/carddav {</span><br><span class="line">        <span class="attribute">return</span> <span class="number">301</span> $scheme://$host/remote.php/dav;</span><br><span class="line">    }</span><br><span class="line">    <span class="attribute">location</span> = /.well-known/caldav {</span><br><span class="line">        <span class="attribute">return</span> <span class="number">301</span> $scheme://$host/remote.php/dav;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    <span class="attribute">location</span> /.well-known/acme-challenge { }</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># set max upload size</span></span><br><span class="line">    <span class="attribute">client_max_body_size</span> <span class="number">512M</span>;</span><br><span class="line">    <span class="attribute">fastcgi_buffers</span> <span class="number">64</span> <span class="number">4K</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Disable gzip to avoid the removal of the ETag header</span></span><br><span class="line">    <span class="attribute">gzip</span> <span class="literal">off</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Uncomment if your server is build with the ngx_pagespeed module</span></span><br><span class="line">    <span class="comment"># This module is currently not supported.</span></span><br><span class="line">    <span class="comment">#pagespeed off;</span></span><br><span class="line"> </span><br><span class="line">    <span class="attribute">error_page</span> <span class="number">403</span> /core/templates/<span class="number">403</span>.php;</span><br><span class="line">    <span class="attribute">error_page</span> <span class="number">404</span> /core/templates/<span class="number">404</span>.php;</span><br><span class="line"> </span><br><span class="line">    <span class="attribute">location</span> / {</span><br><span class="line">        <span class="attribute">rewrite</span><span class="regexp"> ^</span> /index.php$uri;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    <span class="attribute">location</span> <span class="regexp">~ ^/(?:build|tests|config|lib|3rdparty|templates|data)/</span> {</span><br><span class="line">        <span class="attribute">return</span> <span class="number">404</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="attribute">location</span> <span class="regexp">~ ^/(?:\.|autotest|occ|issue|indie|db_|console)</span> {</span><br><span class="line">        <span class="attribute">return</span> <span class="number">404</span>;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    <span class="attribute">location</span> <span class="regexp">~ ^/(?:index|remote|public|cron|core/ajax/update|status|ocs/v[12]|updater/.+|ocs-provider/.+|core/templates/40[34])\.php(?:$|/)</span> {</span><br><span class="line">        <span class="attribute">fastcgi_split_path_info</span><span class="regexp"> ^(.+\.php)(/.*)$</span>;</span><br><span class="line">        <span class="attribute">include</span> fastcgi_params;</span><br><span class="line">        <span class="attribute">fastcgi_param</span> SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br><span class="line">        <span class="attribute">fastcgi_param</span> PATH_INFO $fastcgi_path_info;</span><br><span class="line">        <span class="attribute">fastcgi_param</span> HTTPS <span class="literal">on</span>;</span><br><span class="line">        <span class="attribute">fastcgi_param</span> modHeadersAvailable <span class="literal">true</span>; <span class="comment">#Avoid sending the security headers twice</span></span><br><span class="line">        <span class="attribute">fastcgi_param</span> front_controller_active <span class="literal">true</span>;</span><br><span class="line">        <span class="attribute">fastcgi_pass</span> php-handler;</span><br><span class="line">        <span class="attribute">fastcgi_intercept_errors</span> <span class="literal">on</span>;</span><br><span class="line">        <span class="attribute">fastcgi_request_buffering</span> <span class="literal">off</span>;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    <span class="attribute">location</span> <span class="regexp">~ ^/(?:updater|ocs-provider)(?:$|/)</span> {</span><br><span class="line">        <span class="attribute">try_files</span> $uri $uri/ =<span class="number">404</span>;</span><br><span class="line">        <span class="attribute">index</span> index.php;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Adding the cache control header for js and css files</span></span><br><span class="line">    <span class="comment"># Make sure it is BELOW the PHP block</span></span><br><span class="line">    <span class="attribute">location</span> <span class="regexp">~* \.(?:css|js)$</span> {</span><br><span class="line">        <span class="attribute">try_files</span> $uri /index.php$uri$is_args$args;</span><br><span class="line">        <span class="attribute">add_header</span> Cache-Control <span class="string">&quot;public, max-age=7200&quot;</span>;</span><br><span class="line">        <span class="comment"># Add headers to serve security related headers (It is intended to have those duplicated to the ones above)</span></span><br><span class="line">        <span class="comment"># Before enabling Strict-Transport-Security headers please read into this topic first.</span></span><br><span class="line">        <span class="comment">#add_header Strict-Transport-Security &quot;max-age=15552000; includeSubDomains&quot;;</span></span><br><span class="line">        <span class="attribute">add_header</span> X-Content-Type-Options nosniff;</span><br><span class="line">        <span class="attribute">add_header</span> X-Frame-Options <span class="string">&quot;SAMEORIGIN&quot;</span>;</span><br><span class="line">        <span class="attribute">add_header</span> X-XSS-Protection <span class="string">&quot;1; mode=block&quot;</span>;</span><br><span class="line">        <span class="attribute">add_header</span> X-Robots-Tag <span class="literal">none</span>;</span><br><span class="line">        <span class="attribute">add_header</span> X-Download-Options noopen;</span><br><span class="line">        <span class="attribute">add_header</span> X-Permitted-Cross-Domain-Policies <span class="literal">none</span>;</span><br><span class="line">        <span class="comment"># Optional: Don&#x27;t log access to assets</span></span><br><span class="line">        <span class="attribute">access_log</span> <span class="literal">off</span>;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    <span class="attribute">location</span> <span class="regexp">~* \.(?:svg|gif|png|html|ttf|woff|ico|jpg|jpeg)$</span> {</span><br><span class="line">        <span class="attribute">try_files</span> $uri /index.php$uri$is_args$args;</span><br><span class="line">        <span class="comment"># Optional: Don&#x27;t log access to other assets</span></span><br><span class="line">        <span class="attribute">access_log</span> <span class="literal">off</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> ssl; <span class="comment"># managed by Certbot</span></span><br><span class="line"><span class="attribute">ssl_certificate</span> /etc/letsencrypt/live/mingilin.com/fullchain.pem; <span class="comment"># managed by Certbot</span></span><br><span class="line"><span class="attribute">ssl_certificate_key</span> /etc/letsencrypt/live/mingilin.com/privkey.pem; <span class="comment"># managed by Certbot</span></span><br><span class="line">    <span class="attribute">include</span> /etc/letsencrypt/options-ssl-nginx.conf; <span class="comment"># managed by Certbot</span></span><br><span class="line">    <span class="attribute">ssl_dhparam</span> /etc/letsencrypt/ssl-dhparams.pem; <span class="comment"># managed by Certbot</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Redirect non-https traffic to https</span></span><br><span class="line">    <span class="attribute">if</span> ($scheme != <span class="string">&quot;https&quot;</span>) {</span><br><span class="line">        <span class="attribute">return</span> <span class="number">301</span> https://$host$request_uri;</span><br><span class="line">    } <span class="comment"># managed by Certbot</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure><h3 id="数据导入"><a href="#数据导入" class="headerlink" title="数据导入"></a>数据导入</h3><ul><li>安装<code>davfs</code><br>  需要yum源<a href="https://www.mingilin.com/2016/03/10/centos/centos-yum/">rpmforge</a>, 然后<code>yum install davfs2</code></li><li>挂在到本地<br>  <code>mount -t davfs https://nextcloud.web.mingilin.com/remote.php/webdav/ /root/ttt -o username=你的用户名</code></li><li>在<code>/root/ttt</code>目录下增删文件</li></ul><h3 id="已知问题"><a href="#已知问题" class="headerlink" title="已知问题"></a>已知问题</h3><p><code>nextcloud</code>使用遇到的问题：</p><ol><li><em><strong>服务器要求偏高，在512M的机器上玩不转，负载高的吓人</strong></em></li><li>要求数据库支持</li><li>手动修改用户文件不生效，这个<code>KODExplorer</code>就很好用了</li></ol><p>因为第一点，无奈只能放弃使用，虽然客户端确实很完善，有条件的同学可以试下。</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;记录下自己使用过的开源网盘: &lt;code&gt;KODExplorer&lt;/code&gt;,&lt;code&gt;NextCloud&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="centos" scheme="https://www.mingilin.com/categories/centos/"/>
    
    <category term="linux" scheme="https://www.mingilin.com/categories/centos/linux/"/>
    
    
    <category term="centos" scheme="https://www.mingilin.com/tags/centos/"/>
    
    <category term="linux" scheme="https://www.mingilin.com/tags/linux/"/>
    
    <category term="开源网盘" scheme="https://www.mingilin.com/tags/%E5%BC%80%E6%BA%90%E7%BD%91%E7%9B%98/"/>
    
    <category term="KODExplorer" scheme="https://www.mingilin.com/tags/KODExplorer/"/>
    
    <category term="NextCloud" scheme="https://www.mingilin.com/tags/NextCloud/"/>
    
  </entry>
  
  <entry>
    <title>几种常用git server</title>
    <link href="https://www.mingilin.com/2020/03/13/centos/centos-gitserver-list/"/>
    <id>https://www.mingilin.com/2020/03/13/centos/centos-gitserver-list/</id>
    <published>2020-03-13T06:47:32.000Z</published>
    <updated>2021-07-06T08:26:23.547Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>记录下自己用过的几种<code>git server</code>:<code>GITEA</code>,<code>gitolite3</code>,<code>Gidder/Gitrepo</code></p></blockquote><span id="more"></span><h2 id="GITEA"><a href="#GITEA" class="headerlink" title="GITEA"></a>GITEA</h2><blockquote><p>现在正在用,简单方便,基本的功能都有了</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## install docker</span></span><br><span class="line">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line">yum install -y docker-ce</span><br><span class="line">systemctl <span class="built_in">enable</span> docker</span><br><span class="line">systemctl start docker</span><br><span class="line"></span><br><span class="line"><span class="comment">## gitea</span></span><br><span class="line">docker pull gitea/gitea:latest</span><br><span class="line">mkdir -p /data/gitea</span><br><span class="line">docker run -d --name=gitea -p 2222:22 -p 3000:3000 -v /data/gitea:/data gitea/gitea:latest</span><br><span class="line">docker update --restart=always gitea</span><br></pre></td></tr></table></figure><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## nginx config</span></span><br><span class="line"><span class="attribute">cat</span> &gt; /etc/nginx/conf.d/001_<span class="variable">$&#123;DOMAIN&#125;</span>.conf &lt;&lt; <span class="string">&quot;EOF&quot;</span></span><br><span class="line">server &#123;</span><br><span class="line">    <span class="section">server_name</span>  &#123;DOMAIN&#125;;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>; </span><br><span class="line"></span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://127.0.0.1:3000/;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="gitolite3"><a href="#gitolite3" class="headerlink" title="gitolite3"></a>gitolite3</h2><h3 id="准备key"><a href="#准备key" class="headerlink" title="准备key"></a>准备key</h3><p>安装前先准备公钥,私钥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pi@raspberrypi /data % tree ssh </span><br><span class="line">ssh</span><br><span class="line">├── mingilin</span><br><span class="line">└── mingilin.pub</span><br></pre></td></tr></table></figure><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install gitolite3</span><br><span class="line">正在读取软件包列表... 完成</span><br><span class="line">正在分析软件包的依赖关系树       </span><br><span class="line">正在读取状态信息... 完成       </span><br><span class="line">将会安装下列额外的软件包：</span><br><span class="line">  libcommon-sense-perl libjson-perl libjson-xs-perl</span><br><span class="line">建议安装的软件包：</span><br><span class="line">  git-daemon-sysvinit gitweb</span><br><span class="line">下列【新】软件包将被安装：</span><br><span class="line">  gitolite3 libcommon-sense-perl libjson-perl libjson-xs-perl</span><br><span class="line">升级了 0 个软件包，新安装了 4 个软件包，要卸载 0 个软件包，有 100 个软件包未被升级。</span><br><span class="line">需要下载 0 B/336 kB 的软件包。</span><br><span class="line">解压缩后会消耗掉 1,040 kB 的额外空间。</span><br><span class="line">您希望继续执行吗？[Y/n]y</span><br><span class="line">正在预设定软件包 ...</span><br><span class="line">Selecting previously unselected package libjson-perl.</span><br><span class="line">(正在读取数据库 ... 系统当前共安装有 85705 个文件和目录。)</span><br><span class="line">正在解压缩 libjson-perl (从 .../libjson-perl_2.53-1_all.deb) ...</span><br><span class="line">Selecting previously unselected package gitolite3.</span><br><span class="line">正在解压缩 gitolite3 (从 .../gitolite3_3.6.4-1~bpo70+1_all.deb) ...</span><br><span class="line">Selecting previously unselected package libcommon-sense-perl.</span><br><span class="line">正在解压缩 libcommon-sense-perl (从 .../libcommon-sense-perl_3.6-1_all.deb) ...</span><br><span class="line">Selecting previously unselected package libjson-xs-perl.</span><br><span class="line">正在解压缩 libjson-xs-perl (从 .../libjson-xs-perl_2.320-1_armhf.deb) ...</span><br><span class="line">正在处理用于 man-db 的触发器...</span><br><span class="line">正在设置 libjson-perl (2.53-1) ...</span><br><span class="line">正在设置 gitolite3 (3.6.4-1~bpo70+1) ...</span><br><span class="line">初始化空的 Git 版本库于 /var/lib/gitolite3/repositories/gitolite-admin.git/</span><br><span class="line">初始化空的 Git 版本库于 /var/lib/gitolite3/repositories/testing.git/</span><br><span class="line">WARNING: /var/lib/gitolite3/.ssh missing; creating a new one</span><br><span class="line">    (this is normal on a brand new install)</span><br><span class="line">WARNING: /var/lib/gitolite3/.ssh/authorized_keys missing; creating a new one</span><br><span class="line">    (this is normal on a brand new install)</span><br><span class="line">正在设置 libcommon-sense-perl (3.6-1) ...</span><br><span class="line">正在设置 libjson-xs-perl (2.320-1) ...</span><br></pre></td></tr></table></figure><p><strong>在安装过程中提示输入公钥(.pub), 将公钥的绝对路径输入</strong><br>然后等待安装完成<br>在安装过程中有提示</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">初始化空的 Git 版本库于 /var/lib/gitolite3/repositories/gitolite-admin.git/</span><br><span class="line">初始化空的 Git 版本库于 /var/lib/gitolite3/repositories/testing.git/</span><br></pre></td></tr></table></figure><p>查看权限</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pi@raspberrypi ~ % ll /var/lib|grep gitolite3</span><br><span class="line">drwxr-xr-x 5 gitolite3 gitolite3 4.0K  5月 11 09:56 gitolite3</span><br></pre></td></tr></table></figure><p><strong>说明user是gitolite3</strong></p><h3 id="CLONE"><a href="#CLONE" class="headerlink" title="CLONE"></a>CLONE</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cp /data/ssh/mingilin ~/.ssh/id_rsa &amp;&amp; chmod 400 ~/.ssh/id_rsa</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># GITHOST为服务器IP</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 需要打开git端口9418</span></span></span><br><span class="line">git clone gitolite3@GITHOST:gitolite-admin.git</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 方法2</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># SSHHost为SSH IP</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># SSHPort为SSH端口</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># git clone ssh://gitolite3@SSHHost:SSHPort/gitolite-admin.git</span></span></span><br></pre></td></tr></table></figure><p>权限设置请参考<a href="http://www.server-world.info/en/note?os=CentOS_6&p=gitolite&f=4">http://www.server-world.info/en/note?os=CentOS_6&amp;p=gitolite&amp;f=4</a></p><h3 id="修改用户名"><a href="#修改用户名" class="headerlink" title="修改用户名"></a>修改用户名</h3><p>如果觉得<code>gitolite3@xxxx</code>比较别扭的话,使用<code>sudo usermod -l git gitolite3</code>更改用户名</p><p>然后就可以使用<code>git clone ssh://git@SSHHost:SSHPort/xxx.git</code>了</p><h2 id="基于linux-ssh"><a href="#基于linux-ssh" class="headerlink" title="基于linux ssh"></a>基于linux ssh</h2><h3 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -g git</span><br></pre></td></tr></table></figure><h3 id="创建repo"><a href="#创建repo" class="headerlink" title="创建repo"></a>创建repo</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /repos</span><br><span class="line">git init --bare /repos/test.git</span><br></pre></td></tr></table></figure><h3 id="连接"><a href="#连接" class="headerlink" title="连接"></a>连接</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/.ssh</span><br><span class="line">touch config &amp;&amp; chmod 600 config</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;HostkeyAlgorithms +ssh-dss&quot;</span> &gt;&gt; config</span><br><span class="line">git <span class="built_in">clone</span> ssh://username@ip:port/repos/test.git <span class="built_in">test</span></span><br><span class="line"><span class="comment">## git clone ssh://kingwen0302@192.168.1.100:22/repos/test.git test</span></span><br></pre></td></tr></table></figure><h2 id="Gidder-Gitrepo"><a href="#Gidder-Gitrepo" class="headerlink" title="Gidder/Gitrepo"></a>Gidder/Gitrepo</h2><p><code>Google Play</code>已经找不到这两个软件了<br>个人只备份了一个<a href="/downloads/binary/Gitrepo_0.02.apk">Gitrepo</a></p><h3 id="设置"><a href="#设置" class="headerlink" title="设置"></a>设置</h3><h4 id="Users"><a href="#Users" class="headerlink" title="Users"></a>Users</h4><p><code>setup</code> -&gt; <code>users</code> -&gt; <code>add new user</code></p><h4 id="Repositories"><a href="#Repositories" class="headerlink" title="Repositories"></a>Repositories</h4><p><code>setup</code> -&gt; <code>repositories</code> -&gt; <code>add repository</code> -&gt; <code>add permission</code></p><h3 id="Client"><a href="#Client" class="headerlink" title="Client"></a>Client</h3><p>增加ssh-dss支持</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/.ssh</span><br><span class="line">touch config &amp;&amp; chmod 600 config</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;HostkeyAlgorithms +ssh-dss&quot;</span> &gt;&gt; config</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> ssh://username@ip:port/reponame.git</span><br></pre></td></tr></table></figure><h2 id="gitlab"><a href="#gitlab" class="headerlink" title="gitlab"></a>gitlab</h2><blockquote><p>VPS太垃圾,不敢用</p></blockquote><h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><ol><li><a href="http://www.server-world.info/en/note?os=CentOS_6&p=gitolite">http://www.server-world.info/en/note?os=CentOS_6&amp;p=gitolite</a></li><li><a href="http://www.uml.org.cn/pzgl/201404092.asp">http://www.uml.org.cn/pzgl/201404092.asp</a></li></ol>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;记录下自己用过的几种&lt;code&gt;git server&lt;/code&gt;:&lt;code&gt;GITEA&lt;/code&gt;,&lt;code&gt;gitolite3&lt;/code&gt;,&lt;code&gt;Gidder/Gitrepo&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="centos" scheme="https://www.mingilin.com/categories/centos/"/>
    
    <category term="linux" scheme="https://www.mingilin.com/categories/centos/linux/"/>
    
    
    <category term="centos" scheme="https://www.mingilin.com/tags/centos/"/>
    
    <category term="linux" scheme="https://www.mingilin.com/tags/linux/"/>
    
    <category term="git" scheme="https://www.mingilin.com/tags/git/"/>
    
    <category term="gitea" scheme="https://www.mingilin.com/tags/gitea/"/>
    
    <category term="gitolite3" scheme="https://www.mingilin.com/tags/gitolite3/"/>
    
    <category term="git server" scheme="https://www.mingilin.com/tags/git-server/"/>
    
  </entry>
  
  <entry>
    <title>生成UUID</title>
    <link href="https://www.mingilin.com/2020/03/07/misc/misc-uuid/"/>
    <id>https://www.mingilin.com/2020/03/07/misc/misc-uuid/</id>
    <published>2020-03-07T02:35:20.000Z</published>
    <updated>2021-07-06T08:26:23.596Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="LIUNX"><a href="#LIUNX" class="headerlink" title="LIUNX"></a>LIUNX</h2><p>如果要写脚本的话,可以用下面的,简单</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/sys/kernel/random/uuid</span><br></pre></td></tr></table></figure><h2 id="WINDOWS"><a href="#WINDOWS" class="headerlink" title="WINDOWS"></a>WINDOWS</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell <span class="literal">-Command</span> <span class="string">&quot;Write-Host (New-Guid)&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="windows" scheme="https://www.mingilin.com/categories/windows/"/>
    
    <category term="linux" scheme="https://www.mingilin.com/categories/windows/linux/"/>
    
    <category term="uuid" scheme="https://www.mingilin.com/categories/windows/linux/uuid/"/>
    
    
    <category term="misc" scheme="https://www.mingilin.com/tags/misc/"/>
    
  </entry>
  
</feed>
